@using MyWebPlay.Extension; @if (ViewBag.Show != null && ViewBag.Show == "show" || TempData["ViewSiteBasic"] == "true") { Layout = null; }
<html lang="vi">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
        <title>Karaoke - MyWebPlay</title>
        <link rel="icon" href="/images/karaokeX.png" />
        <style>

            #ajax_papa {
              position: absolute;
              top: 50%;
              left: 50%;
              transform: translate(-50%, -50%);
            }

            #menu {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            width: 100%;
            background-color: grey;
            margin-top: -78px;
            }
            #menu button {
            padding: 10px 20px;
            font-size: 16px;
            border: 2px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            transition: border-color 0.3s ease;
            }
            #menu button:hover {
            border-color: #007bff;
            }
            #menu select,
            #menu input[type="text"],
            #menu input[type="number"] {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 5px;
            transition: border-color 0.3s ease;
            }
            #menu select:focus,
            #menu input[type="text"]:focus,
            #menu input[type="number"]:focus {
            border-color: #007bff;
            outline: none;
            }
            #menu input[type="color"] {
            border: 2px solid #007bff;
            padding: 5px;
            cursor: pointer;
            border-radius: 5px;
            transition: border-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            }
            #menu input[type="color"]:hover {
            border-color: #0056b3;
            transform: scale(1.05);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
            }
            #menu input[type="color"]:focus {
            border-color: #007bff;
            outline: none;
            }
        </style>
        <style>
            .video-overlay {
            position: absolute;
            z-index: 2;
            position: relative;
            }
            * {
            box-sizing: border-box;
            }
            body {
            margin: 0;
            font-family: Arial;
            font-size: 17px;
            }
            #myVidex {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%;
            min-height: 100%;
            max-width: auto;
            max-height: auto;
            }
            #myVideo {
            position: fixed;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            }
            .content {
            position: fixed;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            color: #f1f1f1;
            width: 100%;
            padding: 20px;
            }
            /*---------------------------------------------*/
            /* Safari syntax */
            :-webkit-full-screen {
            background-color: white;
            }
            /* IE11 */
            :-ms-fullscreen {
            background-color: white;
            }
            /* Standard syntax */
            :fullscreen {
            background-color: white;
            }
        </style>
    </head>
    <body id="bodix" ondblclick="momenu()">
        <meta charset="ISO-8859-1" />
        <script>

            //window.onload = function() {
            //    var muteplayPause = document.getElementById('muteplay');
            //    //if (muteplayPause.paused)
            //    //{
            //        muteplayPause.addEventListener('pause', () => {
            //            document.getElementById('muteplay').play();
            //        });
            //    //}

            //    var musicPause = document.getElementById('music');
            //    //if (musicPause.paused)
            //    //{
            //        musicPause.addEventListener('pause', () => {
            //            document.getElementById('music').play();
            //        });
            //    //}

            //    var musixPause = document.getElementById('musix');
            //    //if (musixPause.paused)
            //    //{
            //        musixPause.addEventListener('pause', () => {
            //            document.getElementById('musix').play();
            //        });
            //    //}
            //};
            
            //---------------------------

            var lastTap = 0; // Lưu thời gian lần chạm cuối cùng
            
            function xemdoubleclick()
            {
                var currentTime = new Date().getTime();
                 var tapLength = currentTime - lastTap;
            
            if (tapLength < 500 && tapLength > 0) {
                // Nếu thời gian giữa hai lần chạm nhỏ hơn 500ms thì xem như là nhấp đúp
                dongmomenu();
            }
            
            lastTap = currentTime;
            }

            var lolo = 0;
            setInterval(function()
            {
                if ('@TempData["post-kara"]' == "false") return;

                if ("@ViewBag.LoginServer" != "" && "@ViewBag.LoginServer" != null) return;

                if ('@TempData["DemoKaraoke"]' == "true") return;

                if (lolo == 1) return;

                if ('@TempData["ajax_file_on_off"]' == "True" && '@TempData["ajax_on_off"]' == "True")
                {
                    if (document.getElementById("ajax_mama") != null)
                    {
                        document.getElementById("ajax_mama").style.display = "none";
                        document.getElementById("ajax_papa").style.display = "inline-block";
                        document.getElementById("bodix").style.backgroundColor = 'black';
                        lolo = 1;
                    }
                }

            }, 10);

            var chonVI = 0;
            function okphatnhac()
            {
                 var urlGOC = "";
                 var urlKARAOKE = "";
                 var urlTXT = "";
                if (document.getElementById("fileGOC").files.length > 0)
                {
                     var fileGOC = document.getElementById("fileGOC").files[0];
                     urlGOC = URL.createObjectURL(fileGOC);
                }


                 if (document.getElementById("fileKARAOKE").files.length > 0)
                {
                     var fileKARAOKE = document.getElementById("fileKARAOKE").files[0];
                     urlKARAOKE = URL.createObjectURL(fileKARAOKE);
                }

                if (document.getElementById("fileGOC").files.length > 0)
                {
                     var fileGOC = document.getElementById("fileGOC").files[0];
                     urlGOC = URL.createObjectURL(fileGOC);
                }


                 if (document.getElementById("fileTXT").files.length > 0)
                {
                     const fileTXT = document.getElementById("fileTXT").files[0];
                     urlTXT= URL.createObjectURL(fileTXT);
                }

                if (urlGOC == "")
                {
                    urlGOC = urlKARAOKE;
                }


                if (urlKARAOKE == "")
                {
                    urlKARAOKE = urlGOC;
                }

                if (urlTXT == "" || urlKARAOKE == "" || urlGOC == "")
                {

                    alert("Vui lòng tải lên đầy đủ các thông tin cần thiết...");
                    return;
                }

                var cox = confirm('Bạn có chắc chắn chưa? (kiểm tra lại các dữ liệu đã tải lên của bạn)');
                if (cox == true)
                {
                      document.getElementById("musix").src = urlGOC;
                      document.getElementById("music").src = urlKARAOKE;

                      if (document.getElementById("fileKARAOKE").files.length > 0 && document.getElementById("fileGOC").files.length > 0)
                      {
                          document.getElementById("chon").style.display = "inline-block";
                          chonVI = 1;
                      }
                      else
                      {
                          chonVI = 0;
                      }

                      var xhr = new XMLHttpRequest();
                        xhr.open('GET', urlTXT, true);

                        xhr.onload = function() {
                          if (xhr.status === 200) {
                            var textContent = xhr.responseText;
                            document.getElementById("txtKara").value = textContent;
                          } else {
                            alert("Đã xảy ra lỗi, vui lòng kiểm tra dữ liệu của bạn và thử lại sau !");
                            return;
                          }
                        };

                      xhr.send();
                     document.getElementById("ajax_papa").style.display = "none";
                     document.getElementById("ajax_mama").style.display = "inline-block";
                     resetKaraoke();
                }

            }
            
            var playmute = 0;
            
            function ketquaplay() {
                playmute = 1;
            }
            
            function kiemtracangiua() {
                if (document.getElementById("cangiua").checked == true) {
                    document.getElementById("codinh1").checked = false;
                    document.getElementById("codinh1").style.display = "none";
                    document.getElementById("codinh2").style.display = "none";
                } else {
                    document.getElementById("codinh1").style.display = "inline";
                    document.getElementById("codinh2").style.display = "contents";
                }
            }
            
            function playketqua() {
                playmute = 0;
                document.getElementById("muteplay").play();
            }
            
            if ("@ViewBag.NgauNhien" == "true" && '@TempData["Karaoke_RandomImage"]' == "true") {
                var xs = 0;
            
                setInterval(function () {
                    xs++;
                    var n = new Number("@ViewBag.SoLuongNgauNhien");
                    if (xs >= n) xs = 0;
            
                    document.getElementById("myVideo").src = "/karaoke_Example/background/" + (xs + 1) + ".jpg";
                }, 5000);
            }
            
            var useMauNen = 0;
            
            var sd = 0;
            
            function videovua() {
                if (document.getElementById("vuavideo").checked == true) {
                    document.getElementById("myVidex").style.maxHeight = "100%";
                    documentonprogress("myVidex").style.maxWidth = "100%";
                } else {
                    document.getElementById("myVidex").style.maxHeight = "1000%";
                    documentonprogress("myVidex").style.maxWidth = "1000%";
                }
            }
            
            if ('@TempData["post-kara"]' == "true") {
                document.addEventListener("DOMContentLoaded", (event) => {
                    document.body.addEventListener("keydown", (e) => {
                        if (e.key === "M" || e.key === "m") {
                            dongmomenu();
                        }
            
                        if ('@TempData["hassinger"]' != "true" || chonVI == 1) {
                            if (e.key === "c" || e.key === "C") {
                                if (document.getElementById("chon").options.selectedIndex == 0) {
                                    document.getElementById("chon").options.selectedIndex = 1;
                                } else {
                                    document.getElementById("chon").options.selectedIndex = 0;
                                }
                                changeKara();
                            }
                        }
            
                        if (e.keyCode == 32)
                        {
                            loadsolar();
                        }
            
                        if (e.key == "o" || e.key == "O")
                        {
                            resetKaraoke();
                        }
            
                        if (notice == 1)
                        {
                            if (e.key == "x" || e.key == "X")
                            {
                                  document.getElementById("message").style.display = "none";
                                 document.getElementById("error").style.display = "none";
                                document.getElementById("error").innerHTML = "";
                                notice = 0;
                            }
                        }
                    });
                });
            }
            
            function loadauto() {
                if (sd == 1 || '@TempData["index-auto"]' == null || '@TempData["index-auto"]' == "" || document.getElementById("getlist").innerHTML != '<span style="color:green">Successful!</span>') return;
            
                if ('@TempData["post-kara"]' == "false") {
                    var indes = '@TempData["index-auto"]'.split("***");
                    var index = 0;
                    if (indes.length == 2) {
                        index = new Number(indes[0]) - 1;
                    } else {
                        index = new Number(indes[0]);
                    }
            
                    document.getElementById("listsong").options.selectedIndex = index;
                    changesong();
                    document.getElementById("chonKara").options.selectedIndex = 4;
                    document.getElementById("chonKarax").value = "5";
                    document.getElementById("autoSong").checked = "true";
                    document.getElementById("okxem").click();
                } else {
                    loadsolar();
                }
                sd = 1;
            }
            
            setInterval(function () {
                loadauto();
            
                const detectDeviceType = () =>
                    // Use a regular expression to test the userAgent string for common mobile device identifiers.
                    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)
                        ? "Mobile" // If any of the identifiers are found, return 'Mobile'.
                        : "Desktop"; // Otherwise, return 'Desktop'.
            
                if ('@TempData["cangiua"]' == "false" && '@TempData["codinh"]' == "true") {
                    if (detectDeviceType() == "Mobile") {
                        document.getElementById("txtKaraoke1").style.bottom = "50px";
                        document.getElementById("number").style.bottom = "200px";
                    } else {
                        document.getElementById("txtKaraoke1").style.bottom = "200px";
                        document.getElementById("number").style.bottom = "500px";
                    }
                }

                //--------------------------------

                //if ('@TempData["post-kara"]' == "true" && flg == 1) {
                //    var musixPause = document.getElementById('musix');
                //    var musicPause = document.getElementById('music');

                //    if (musixPause.paused || musicPause.paused)
                //    {
                //        resetKaraoke();
                //        musicPause.play();
                //        musixPause.play();
                //        replay_Youtube();
                //    }
                //}

            }, 10);
            
            function playAutoList() {
                document.getElementById("listsong").options.selectedIndex = 0;
                changesong();
                document.getElementById("chonKara").options.selectedIndex = 4;
                document.getElementById("chonKarax").value = "5";
                document.getElementById("autoSong").checked = "true";
                document.getElementById("okxem").click();
            }
            
            // Delete div somee
            
            setInterval(function () {
                $(document).ready(function () {
                    $("div[style='opacity: 0.9; z-index: 2147483647; position: fixed; left: 0px; bottom: 0px; height: 65px; right: 0px; display: block; width: 100%; background-color: #202020; margin: 0px; padding: 0px;']").remove();
                    $("div[style='margin: 0px; padding: 0px; left: 0px; width: 100%; height: 65px; right: 0px; bottom: 0px; display: block; position: fixed; z-index: 2147483647; opacity: 0.9; background-color: rgb(32, 32, 32);']").remove();
                    $("div[onmouseover='S_ssac();']").remove();
                    $("center").remove();
                    $("div[style='height: 65px;']").remove();
                });
            }, 10);
            
            function xong() {
                if (playmute == 0) {
                    alert("Vui lòng chờ trong ít phút hoặc load lại trang. Xin lỗi vì sự bất tiện này (hệ thống đang tiến hành xử lý lại) !");
                    return;
                }
            
                document.getElementById("okxem").style.display = "none";
                document.getElementById("loading").style.display = "block";
            }

            var lancop = 0;
            
            function copyshare() {
                //if (dFlag == 1)
                //{
                //     document.getElementById("message").style.display = "block";
                //  document.getElementById("error").style.display = "block";
                //document.getElementById("error").innerHTML = "⚠️ Xử lý thất bại, do đang có nội dung bản text Karaoke đang được mã hoá nhưng chưa được giải mã. Vui lòng thử lại sau !";
                //    return;
                //}
                var mi = "";
            
                //if ('@TempData["data-encrypt"]' == "true")
                //mi = "<encrypt>";
            
                var luutru = "";
            
                if (document.getElementById("saveshare").checked == true) {
                    var hangR = "[NULL]";
                    var mauR = "[NULL]";
            
                    if ('@TempData["TK-KARA"]' == "" || '@TempData["codinh"]' == "false") {
                        hangR = document.getElementById("hang").value;
                        mauR = document.getElementById("mau").value.replace("#", "");
                    }
            
                    var mauXR = document.getElementById("mauX").value.replace("#", "");
                    var mauYR = document.getElementById("mauY").value.replace("#", "");
                    var kichthuocR = document.getElementById("kichthuoc").value;
                    var fontKieuR = document.getElementById("fontKieu").options.selectedIndex;
                    // var kieudemnguocR = document.getElementById("kieudemnguoc").value;
                    var kieudemnguocR = document.getElementById("kieudemnguoc").value;
                    var maunexR = document.getElementById("maunex").value.replace("#", "");
                    var anhmoR = document.getElementById("anhmo").value;
            
                    luutru = "&&setting=" + hangR + "<>" + mauR + "<>" + mauXR + "<>" + mauYR + "<>" + kichthuocR + "<>" + fontKieuR + "<>" + kieudemnguocR + "<>" + maunexR + "<>" + anhmoR;
                }
            
                var url = '@TempData["https_url"]' + "://" + "@ViewBag.Host" + "/Home/Share_Karaoke?id=" + document.getElementById("linkKara").value + mi + luutru;

                var formData = new FormData();
                formData.append("url", url);
                $.ajax({
                    url: "/Home/EncodeUrlData",
                    type: "POST",
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function(data) {

                        var urlFull = '@TempData["https_url"]' + "://" + "@ViewBag.Host" + "/Home/RedirectUrlEncode?id=share_karaoke&&code=" + data.url;
            
                    if (lancop % 2 == 0)
                    {
                          navigator.clipboard.writeText(urlFull);
                    }

                document.getElementById("message").style.display = "block";
                document.getElementById("error").style.display = "block";

                if (lancop % 2 == 0)
                {
                document.getElementById("error").innerHTML = "✔️ Một url chia sẻ Karaoke đã được copy vào Clipboard của bạn. Hãy chia sẻ bài hát này và mang niềm vui đến bạn bè mình nhé !";
                }
                else
                {
                     document.getElementById("error").innerHTML = "✔️ Một url chia sẻ Karaoke đã được xuất ra ở TextBox bên dưới. Hãy chia sẻ bài hát này và mang niềm vui đến bạn bè mình nhé (nhấn lân nữa để copy - nếu có thể) !<br /><input type='text' size='180' value='"+urlFull+"'readonly />";
                }
                notice = 1;
            }});

            lancop++;
            }
            
            var idX;
            idX = setInterval(myAlertX, 1000);
            
            var dFlag = 0;
            var notice = 0;
            
            var duYou = 0;
            var durationYoutube = '@TempData["duration-Youtube"]';
            var duMusic = 0;
            setInterval(function () {
                if ('@TempData["post-kara"]' == "true") {
                    if ('@TempData["auto-music"]' == "true") {
                        duMusic++;
                        var duMusix = new Number(document.getElementById("music").duration);
                        if (duMusic >= duMusix - 1) {
                            duMusic = 0;
                            resetKaraoke();
                        }
                    }
            
                    if ("@ViewBag.SuDung" == "Youtube") {
                        window.location.href = "#" + '@TempData["id-youtube"]';
            
                        var duraYou = new Number(durationYoutube);
                        if (durationYoutube != "no") {
                            duYou++;
                            if (duYou >= duraYou) {
                                duYou = 0;
                                document.getElementById("re-You").click();
                            }
                        }
                    }
                }
            }, 1000);
            
            var so = 0;
            function myAlertX() {
                if ("@ViewBag.Share" != "YES" && "@ViewBag.Share" != "OK") {
                    clearInterval(idX);
                    return;
                }
            
                so++;
            
                if ("@ViewBag.Share" == "YES") {
                    if (so < 5) return;
            
                    if ("@ViewBag.Option" == "1") {
                        document.getElementById("chonKarax").value = 1;
                        document.getElementById("chonKara").options.selectedIndex = 0;
                    } else if ("@ViewBag.Option" == "2") {
                        document.getElementById("chonKarax").value = 2;
                        document.getElementById("chonKara").options.selectedIndex = 1;
                        document.getElementById("online").value = "@ViewBag.Background";
                        document.getElementById("online").style.display = "block";
                    } else if ("@ViewBag.Option" == "3") {
                        document.getElementById("chonKarax").value = 3;
                        document.getElementById("chonKara").options.selectedIndex = 2;
                        document.getElementById("online").value = "@ViewBag.Background";
                        document.getElementById("online").style.display = "block";
                    } else if ("@ViewBag.Option" == "4") {
                        document.getElementById("chonKarax").value = 4;
                        document.getElementById("chonKara").options.selectedIndex = 3;
                        document.getElementById("online").value = "@ViewBag.Background";
                        document.getElementById("online").style.display = "block";
                    } else if ("@ViewBag.Option" == "5") {
                        document.getElementById("chonKarax").value = 5;
                        document.getElementById("chonKara").options.selectedIndex = 4;
                        document.getElementById("online").style.display = "none";
                    }
            
                    document.getElementById("okxem").click();
                } else if ("@ViewBag.Share" == "OK") {
                    document.getElementById("getlist").click();
                    clearInterval(idX);
                }
            }
            
            function thoatServer() {
                window.location.href = "/Home/ToPlayKaraoke";
            }
            
            function changesong() {
                var e = document.getElementById("listsong");
                var song = e.options[e.selectedIndex].text;
                document.getElementById("baihatX").value = song;
                nas = true;
            }
            
            function showlist() {
                if (document.getElementById("getlist").innerHTML == '<span style="color:green">Successful!</span>') return;
            
                if (document.getElementById("serverX").value == "") {
                    document.getElementById("serverX").value = '@TempData["link-karaoke-demo"]';
                }
            
                if (document.getElementById("songlist").value == "") {
                    var url = document.getElementById("serverX").value;
                    var baihat = document.getElementById("baihatX").value;
            
                    alert(
                        "Xử lý thành công, hệ thống sẽ khởi động lại trang web (nếu bạn chưa nhập, hệ thống sẽ tự động lấy mẫu demo của chúng tôi cho bạn trải nghiệm). Nếu danh sách của bạn chưa được tải xuống, vui lòng click lại vào link nút này một lần nữa để hoàn tất thử lại việc tải các bài hát đã get trên Server host của bạn..."
                    );
            
                    var thongtin = url + "[NONE]" + "-.-" + baihat + "[NONE]" + "-.-[NOT]-.-0";
            
                    //navigator.clipboard.writeText(thongtin);
            
                    window.location.href = "/Home/Share_Karaoke?id=" + thongtin;
                } else;
                {
                    var noidung = document.getElementById("songlist").value.split("\n");
                    var listsong = document.getElementById("listsong");
            
                    listsong.innerHTML = "";
                    var dem = 0;
                    for (var i = 0; i < noidung.length; i++) {
                        if (noidung[i] != "") {
                            listsong.innerHTML += '<option value="' + noidung[i] + '">' + noidung[i] + "</option>";
                            dem++;
                        }
                    }
                    document.getElementById("soluongSong").innerHTML = "Hiện tại Karaoke trên host server của bạn có : " + dem + " bài hát.";
                    document.getElementById("songlist").value = "";
                    document.getElementById("getlist").innerHTML = '<span style="color:green">Successful!</span>';
                }
            }
            
            function helpKara() {
                alert(
                    "[CẢM PHIỀN BẠN HÃY ĐỌC HƯỚNG DẪN NHANH TẠI ĐÂY 😁]\n\n[1/2]\n\n1. Đăng kí host server name :\n\nLưu ý, hệ thống đang hướng dẫn bạn đăng kí host server bằng trang web của freeasphosting.net, nếu bạn có thể tìm kiếm được các trang web dịch vụ hỗ trợ host server khác thì cũng có thể áp dụng và các cách thực hiện cũng tương tự.\n\n- Truy cập : http://freeasphosting.net/ và đăng kí tài khoản mới (nếu bạn chưa có) tại Create Your Web Site\n\n- Đăng nhập tài khoản và vào mục quản lý file.\n\n- Mỗi một bài hát karaoke của bạn phải được đặt trong từng các thư mục riêng biệt.\n\n- Quy tắc như sau để phù hợp với dịch vụ Karaoke của MyWebPlay : ví dụ bạn có karaoke bài hát tên là Mùa xuân của em, tạo thư mục MuaXuanCuaEm và bên trong thư mục bạn có thể dùng chức năng Upload để tải lên đúng 3 file liên quan vào trong thư mục này. 3 file liên quan đó chính là : file txt nội dung karaoke, file mp3 nhạc bao gồm cả giọng ca sĩ và file mp3 đã tách nhạc."
                );
                alert(
                    "[CẢM PHIỀN BẠN HÃY ĐỌC HƯỚNG DẪN NHANH TẠI ĐÂY 😁]\n\n[2/2]\n\n- Tuy nhiên, 3 file bạn tải lên cũng phải đặt tên theo quy tắc. Ở ví dụ thư mục MuaXuanCuaEm trên, file txt nội dung bạn có thể đặt là MuaXuanCuaEm.txt, file mp3 bản gốc bạn có thể đặt là MuaXuanCuaEm_Goc.mp3 và file mp3 đã tách nhạc thì có thể đặt là MuaXuanCuaEm.mp3\n\n=> Lưu ý bạn phải đặt đúng các tên file và thư mục Karaoke theo đúng nguyên tắc trên, nếu không sẽ gây ra lỗi và khó xử lý 😂\n\n2. Sử dụng host server của bạn để Play Karaoke :\n\n- Nhập tên host server name của bạn, chính là thông tin username mà bạn đã tạo tài khoản tại freeasphosting.net trước đó (ví dụ : yourusername.bsite.net). Lưu ý nếu bạn đã tạo host server web không phải của freeasphosting.net thì hãy chú ý tương tự.\n\n- Nhập bài hát tại Server Karaoke của bạn, chính là tên thư mục bạn đã đặt và upload tại server (ví dụ MuaXuanCuaEm). Lưu ý thư mục của bạn chỉ bao gồm đủ và đúng 3 file liên quan trên\n\n=> Chúc mọi người thành công và thưởng thức 🥰!"
                );
            }
            
            function onlinecheck() {
                if (document.getElementById("onlineServer").checked == true) {
                    document.getElementById("phan1").style.display = "none";
                    document.getElementById("phan2").style.display = "none";
                    document.getElementById("phan3").style.display = "none";
                    document.getElementById("check").style.display = "none";
                    document.getElementById("phan4").style.display = "block";
                    document.getElementById("phan5").style.display = "block";
                    document.getElementById("phan6").style.display = "block";
                } else {
                    document.getElementById("phan1").style.display = "block";
                    document.getElementById("phan2").style.display = "block";
                    document.getElementById("phan3").style.display = "block";
                    document.getElementById("check").style.display = "block";
                    document.getElementById("phan4").style.display = "none";
                    document.getElementById("phan5").style.display = "none";
                    document.getElementById("phan6").style.display = "none";
                }
            }
            
            function doimaunenX() {
                var mau = document.getElementById("maunenX").value;
                document.getElementById("demo_nen").style.color = mau;
            
                var x = document.getElementById("background-X");
                x.style.backgroundColor = mau;
            
                useMauNen = 1;
            }
            
            function xoamaunen() {
                document.getElementById("demo_nen").style.color = "#FFFFFF";
                document.getElementById("maunenX").value = "#FFFFFF";
            
                var x = document.getElementById("background-X");
            
                if (useMauNen == 0 || useMauNen == 1) {
                    x.style.backgroundColor = "rgba(0, 0, 0, 0.4)";
                    useMauNen = 2;
                } else {
                    x.style.backgroundColor = "transparent";
                    useMauNen = 0;
                }
            }
            
            function doikichthuoc() {
                var kt = document.getElementById("kichthuoc").value + "px";
                document.getElementById("txtKaraoke1").style.fontSize = kt;
                document.getElementById("txtKaraoke2").style.fontSize = kt;
                document.getElementById("number").style.fontSize = kt;
            }
            
            function doikichthuoc_Save() {
                if (localStorage.getItem("kichthuoc") == null
                 || document.getElementById("kichthuoc") == null || document.getElementById("txtKaraoke1") == null || document.getElementById("txtKaraoke2") == null  || document.getElementById("number") == null) return;
            
                var kichthuoc = localStorage.getItem("kichthuoc");
                var kt = kichthuoc + "px";
                document.getElementById("kichthuoc").value = kichthuoc;
                document.getElementById("txtKaraoke1").style.fontSize = kt;
                document.getElementById("txtKaraoke2").style.fontSize = kt;
                document.getElementById("number").style.fontSize = kt;
            }
            
            function doihang() {
                var hang = new Number(document.getElementById("hang").value);
                var hax = "";
                for (var i = 0; i < hang; i++) hax += "<br>";
            
                document.getElementById("hienthi").innerHTML = hax;
            }
            
            function doihang_Save() {
                if (localStorage.getItem("hang") == null
                ||  document.getElementById("hang") == null) return;
            
                var hang = new Number(localStorage.getItem("hang"));
            
                if ('@TempData["TK-KARA"]' != "" || '@TempData["codinh"]' == "true") hang = 0;
            
                document.getElementById("hang").value = hang;
            
                var hax = "";
                for (var i = 0; i < hang; i++) hax += "<br>";
            
                document.getElementById("hienthi").innerHTML = hax;
            }
            
            function chonKaraHay() {
                var chon = document.getElementById("chonKara").options.selectedIndex;
                var chonX = document.getElementById("chonKarax");
                var online = document.getElementById("online");
                var help = document.getElementById("helpYoutube");
                var help2 = document.getElementById("Youtubehelp");
                if (chon == 0) {
                    online.style.display = "none";
                    help.style.display = "none";
                    help2.style.display = "none";
                    chonX.value = "1";
                } else if (chon == 1) {
                    chonX.value = "2";
                    online.style.display = "block";
                    help.style.display = "none";
                    help2.style.display = "none";
                } else if (chon == 2) {
                    chonX.value = "3";
                    online.style.display = "block";
                    help.style.display = "none";
                    help2.style.display = "none";
                } else if (chon == 3) {
                    chonX.value = "4";
                    online.style.display = "block";
                    help.style.display = "block";
                    help2.style.display = "block";
                } else if (chon == 4) {
                    chonX.value = "5";
                    online.style.display = "none";
                    help.style.display = "none";
                    help2.style.display = "block";
                }
            }
            
            function dongmomenu() {
                var menu = document.getElementById("menu");
                var hienlinh = document.getElementById("hienlinh");
            
                if (menu.style.display == "block") {
                    menu.style.display = "none";
                    hienlinh.style.display = "block";
                } else {
                    menu.style.display = "block";
                    hienlinh.style.display = "none";
                }
            }
            
            function dongmenu()
            {
                 var menu = document.getElementById("menu");
                var hienlinh = document.getElementById("hienlinh");
            
                 if (menu.style.display == "block") {
                    menu.style.display = "none";
                    hienlinh.style.display = "block";
                } 
            }
            
            
            function momenu()
            {
                var menu = document.getElementById("menu");
                var hienlinh = document.getElementById("hienlinh");
            
                 if (menu.style.display == "none") {
                     menu.style.display = "block";
                    hienlinh.style.display = "none";
                } 
            }
            
            var elem = document.documentElement;
            
            function loadsolar() {
                var xanh = document.getElementById("xanh");
                if ("@ViewBag.Show" == "show") {
                    if (xanh.innerHTML == "<b>FULL MÀN HÌNH - OFF</b>") {
                        if (elem.requestFullscreen) elem.requestFullscreen();
                        else if (elem.webkitRequestFullscreen) /* Safari */ elem.webkitRequestFullscreen();
                        else if (elem.msRequestFullscreen) /* IE11 */ elem.msRequestFullscreen();
            
                        xanh.innerHTML = "<b>FULL MÀN HÌNH - ON</b>";
                        dongmomenu();
                        document.getElementById("message").style.display = "block";
                        document.getElementById("error").style.display = "block";
                        document.getElementById("error").innerHTML = "Lưu ý : Khi bật chế độ full màn hình, các option menu sẽ bị ẩn (nhằm mở rộng không gian). Bạn cũng có thể nhấn phím M hoặc m để hiện/ẩn khung menu (hoặc nhấn đúp vào màn hình || hoặc click vào nội dung text Karaoke đang chạy). MẸO BỔ SUNG : hãy rê chuột vào các nút và các element đang có ở khung menu để hiện hướng dẫn sử dụng cũng như các phím tắt cần thiết nhé.";
                        notice = 1;
                    } else {
                        if (document.exitFullscreen) {
                            document.exitFullscreen();
                        } else if (document.webkitExitFullscreen) {
                            /* Safari */
                            document.webkitExitFullscreen();
                        } else if (document.msExitFullscreen) {
                            /* IE11 */
                            document.msExitFullscreen();
                        }
            
                        var menu = document.getElementById("menu");
                        var hienlinh = document.getElementById("hienlinh");
            
                        if (menu.style.display != "block") {
                            menu.style.display = "block";
                            hienlinh.style.display = "none";
                        }
            
                        xanh.innerHTML = "<b>FULL MÀN HÌNH - OFF</b>";
            
                        document.getElementById("message").style.display = "none";
                        document.getElementById("error").style.display = "none";
                        document.getElementById("error").innerHTML = "";
                        notice = 0;
                    }
                }
            }
            
            var you = false;
            var youX = false;
            
            function PlayY() {
                if (document.getElementById("music").currentTime != document.getElementById("musix").currentTime) document.getElementById("music").currentTime = document.getElementById("musix").currentTime;
            }
            
            function PlayZ() {
                if (document.getElementById("music").currentTime != document.getElementById("musix").currentTime) document.getElementById("musix").currentTime = document.getElementById("music").currentTime;
            }
            
            window.onresize = function (event) {
                var height = screen.height;
                var width = screen.width;
            
                var kichthuoc = new Number(width / 19).toFixed();
                var vitri = new Number(height / 170).toFixed();
            
                if ('@TempData["TK-Kara"]' != "" || '@TempData["codinh"]' == "true") {
                    vitri = 0;
                    document.getElementById("hang").value = vitri;
                }
            
                if (localStorage.getItem("kichthuoc") == null) {
                    document.getElementById("kichthuoc").value = kichthuoc;
                    doikichthuoc();
                }
            
                if ('@TempData["codinh"]' == "false" && localStorage.getItem("hang") == null) document.getElementById("hang").value = vitri;
            };
            
            var flix = 0;
            var sai = 0;
            var behind = 0;
            var be = 0;
            
            setInterval(function () {
                if (behind == 0 && '@TempData["behind"]' == "true") {
                    be++;
                    if (be == new Number('@TempData["behind-number"]')) {
                        behind = 1;
                        document.getElementById("musix").play();
                        document.getElementById("music").play();
            
                        if ("@ViewBag.SuDung" == "Video") {
                            document.getElementById("myVidex").currentTime = 0;
                        }
                    }
                }
            }, 1000);
            
            var t_notice = 0;
            
            setInterval(function () {
                if (notice == 0) return;
            
                t_notice++;
                if (t_notice == 20) {
                    t_notice = 0;
                    notice = 0;
            
                    document.getElementById("message").style.display = "none";
                    document.getElementById("error").style.display = "none";
                    document.getElementById("error").innerHTML = "";
                    document.getElementById("loadingX").style.display = "none";
                }
            }, 1000);
            
            function PlayKaraoke() {
                //if (sai == 0 && '@ViewBag.BehindYoutube' == "YES" && '@ViewBag.Share' != "YES" && '@ViewBag.Share' != "YES - OK")
            
                if (sai == 0 && ('@TempData["auto-play"]' == "false" || '@TempData["behind"]' == "true")) {
                    document.getElementById("musix").pause();
                    document.getElementById("music").pause();
                    you = false;
                    sai = 1;
                    return;
                }
            
                document.getElementById("error").style.display = "none";
                document.getElementById("error").innerHTML = "";
            
                if (document.getElementById("music").currentTime != document.getElementById("musix").currentTime) document.getElementById("music").currentTime = document.getElementById("musix").currentTime;
            
                document.getElementById("musix").play();
            
                you = true;
            }
            
            function ToPlayKaraoke() {
                if (sai == 0 && '@TempData["auto-play"]' == "false") {
                    document.getElementById("music").pause();
                    document.getElementById("musix").pause();
                    you = false;
                    sai = 1;
                    return;
                }
            
                if (document.getElementById("musix").currentTime != document.getElementById("music").currentTime) document.getElementById("musix").currentTime = document.getElementById("music").currentTime;
            
                document.getElementById("music").play();
                youX = true;
            }
            
            var mi = 0;
            var chiase  = 0;
            setInterval(function () {
                if (mi == 1) return;
            
                var fontKara = '@TempData["fontKara"]'.replaceAll("&#xD;&#xA;", "\n").split("\n");
            
                for (var i = 0; i < fontKara.length; i++) document.getElementById("fontKieu").innerHTML += '<option style="font-family:' + fontKara[i] + '">' + fontKara[i] + "</option>";
            
                mi = 1;
            
                if (chiase == 0 && "@ViewBag.Share" == "YES - OK") {
                    document.getElementById("message").style.display = "block";
                    document.getElementById("error").style.display = "block";
                    document.getElementById("error").innerHTML = "Nếu bạn play karaoke bằng link chia sẻ của bạn bè, ban đầu vui lòng nhấn nút [Khởi động lại] hoặc nhấn phím o/O để phát trình nhạc...";
                    notice = 1;
                    chiase = 1;
                    return;
                }
            }, 10);
            
            var t = 0;
            var kk = 0;
            var empty = -1;
            
            var flag = 0;
            var n = 0;
            var kf = 0;
            var ix = 0;
            
            function resetKaraoke() {
                document.getElementById("musix").currentTime = 0;
                document.getElementById("music").currentTime = 0;
                duMusic = 0;
                doiFontKieu();
                moanh();
            
                t = 0;
                kk = 0;
                empty = -1;
                so = 0;
            
                flag = 0;
                n = 0;
                kf = 0;
            
                document.getElementById("txtKaraoke1").innerHTML = "";
                document.getElementById("txtKaraoke2").innerHTML = "";
                document.getElementById("txtKara1").value = "";
                document.getElementById("txtKara2").value = "";
                document.getElementById("number").innerHTML = "";
            
                document.getElementById("thietkeKara").innerHTML = "";
                ix = 0;
            }
            
            function xoaerror() {
                document.getElementById("message").style.display = "none";
                document.getElementById("error").style.display = "none";
                document.getElementById("error").innerHTML = "";
                document.getElementById("loadingX").style.display = "none";
                notice = 0;
                t_notice = 0;
            }
            
            function xoaghinho() {
                localStorage.removeItem("mau");
                localStorage.removeItem("hang");
                localStorage.removeItem("mauX");
                localStorage.removeItem("mauY");
                localStorage.removeItem("kichthuoc");
                localStorage.removeItem("kieuchu");
                localStorage.removeItem("kieudemnguoc");
                // localStorage.removeItem("dotre");
            
                localStorage.removeItem("maunen", "none");
            
                localStorage.removeItem("maunex");
                localStorage.removeItem("anhmo");
            
                document.getElementById("message").style.display = "block";
                document.getElementById("error").style.display = "block";
                document.getElementById("error").innerHTML = "✔️ Các cài đặt Karaoke của bạn đã được xoá ghi nhớ và trở lại mặc định ban đầu, hãy thử lại Play Karaoke trong lần tiếp theo.";
                notice = 1;
            }
            
            function ghinho() {
                if ("@ViewBag.Share" == "YES - OK") {
                    document.getElementById("message").style.display = "block";
                    document.getElementById("error").style.display = "block";
                    document.getElementById("error").innerHTML = "⚠️ Xin lỗi, tính năng ghi nhớ cài đặt không thể áp dụng nếu bạn đang sử dụng Karaoke bằng link chia sẻ từ bạn bè !";
                    notice = 1;
                    return;
                }
            
                if ('@TempData["TK-KARA"]' == "" || '@TempData["codinh"]' == "false") {
                    localStorage.setItem("mau", document.getElementById("mau").value);
                    localStorage.setItem("hang", document.getElementById("hang").value);
                }
                localStorage.setItem("mauX", document.getElementById("mauX").value);
                localStorage.setItem("mauY", document.getElementById("mauY").value);
                localStorage.setItem("kichthuoc", document.getElementById("kichthuoc").value);
                localStorage.setItem("kieuchu", document.getElementById("fontKieu").options.selectedIndex);
                localStorage.setItem("kieudemnguoc", document.getElementById("kieudemnguoc").value);
                // localStorage.setItem("dotre", document.getElementById("dotre").value);
            
                if ('@TempData["codinh"]' == "false") {
                    if (useMauNen == 0) localStorage.setItem("maunen", "none");
                    else if (useMauNen == 1) localStorage.setItem("maunen", document.getElementById("maunenX").value);
                    else if (useMauNen == 2) localStorage.setItem("maunen", "blue");
                }
            
                localStorage.setItem("maunex", document.getElementById("maunex").value);
                localStorage.setItem("anhmo", document.getElementById("anhmo").value);
            
                document.getElementById("message").style.display = "block";
                document.getElementById("error").style.display = "block";
                document.getElementById("error").innerHTML = "✔️ Các cài đặt Karaoke của bạn đã được ghi nhớ thành công (chú ý : một số setting có thể sẽ tự ý thay đổi một chút để phù hợp với hoàn cảnh) !";
                notice = 1;
            
                var menu = document.getElementById("menu");
                var hienlinh = document.getElementById("hienlinh");
            
                if (menu.style.display != "block") {
                    menu.style.display = "block";
                    hienlinh.style.display = "none";
                }
                document.getElementById("xanh").innerHTML = "<b>FULL MÀN HÌNH - OFF</b>";
            }
            
            function PlayXKaraoke() {
                document.getElementById("musix").pause();
            
                you = false;
            }
            
            function restart_Youtube() {
                if ("@ViewBag.SuDung" == "Youtube") {
                    document.getElementById("phanphoi").innerHTML = '<iframe id="myVideo" style="pointer-events: none;" src="' + "@ViewBag.Background" + '"></iframe>';
                    duYou = 0;
                } else if ("@ViewBag.SuDung" == "Video") {
                    document.getElementById("myVideo").currentTime = 0;
                }
            }
            
            function replay_Youtube() {
                duMusic = 0;
                if ("@ViewBag.SuDung" == "Youtube") {
                    duYou = 0;
                    document.getElementById("phanphoi").innerHTML = '<iframe id="myVideo" style="pointer-events: none;" src="' + "@ViewBag.Background" + '"></iframe>';
                } else if ("@ViewBag.SuDung" == "Video") {
                    document.getElementById("myVideo").currentTime = 0;
                }
            
                resetKaraoke();
            }
            
            function xemplay() {
                //if ('@ViewBag.SuDung' == "Youtube")
                //{
                //document.getElementById("phanphoi").innerHTML= "<iframe id=\"myVideo\" src=\""+'@ViewBag.Background'+"\"></iframe>";
                //}
                //else if ('@ViewBag.SuDung' == "Video")
                //{
                //    document.getElementById("myVideo").currentTime = 0;
                //}
            
                dongmomenu();
                if (elem.requestFullscreen) elem.requestFullscreen();
                else if (elem.webkitRequestFullscreen) /* Safari */ elem.webkitRequestFullscreen();
                else if (elem.msRequestFullscreen) /* IE11 */ elem.msRequestFullscreen();
            
                document.getElementById("xanh").innerHTML = "<b>FULL MÀN HÌNH - ON</b>";
            
                document.getElementById("musix").play();
                document.getElementById("music").play();
            
                document.getElementById("xplay1").style.display = "none";
                document.getElementById("xplay2").style.display = "none";
                // resetKaraoke();
            }
            
            function xemplayX() {
                //if ('@ViewBag.SuDung' == "Youtube")
                //{
                //document.getElementById("phanphoi").innerHTML= "<iframe id=\"myVideo\" src=\""+'@ViewBag.Background'+"\"></iframe>";
                //}
                //else if ('@ViewBag.SuDung' == "Video")
                // {
                //     document.getElementById("myVideo").currentTime = 0;
                // }
            
                //dongmomenu();
                //if (elem.requestFullscreen)
                //            elem.requestFullscreen();
                //             else if (elem.webkitRequestFullscreen) /* Safari */
                //            elem.webkitRequestFullscreen();
                //           else if (elem.msRequestFullscreen) /* IE11 */
                //            elem.msRequestFullscreen();
            
                //            document.getElementById("xanh").innerHTML = "<b>FULL MÀN HÌNH - ON</b>";
            
                document.getElementById("musix").play();
                document.getElementById("music").play();
            
                document.getElementById("xplay1").style.display = "none";
                document.getElementById("xplay2").style.display = "none";
                duMusic = 0;
                // resetKaraoke();
            }
            
            function PlayXKaraokeX() {
                document.getElementById("music").pause();
                youX = false;
            }
            
            function changeKara() {
                var chon = document.getElementById("chon").options.selectedIndex;
            
                if (chon == 0) {
                    document.getElementById("music").muted = false;
                    document.getElementById("musix").muted = true;
                } else {
                    document.getElementById("music").muted = true;
                    document.getElementById("musix").muted = false;
                }
            }
            
              var loadxong = 0;
            
            function chonsongtulist()
            {
                if (loadxong == 0) return;
            
                document.getElementById("baihatXYZ").innerHTML = "<img style=\"width: 50px; height: 50px;\" id=\"loadingX\" src=\"/Image_Play/waiting.gif\" />";
            
                var baihatcu = document.getElementById("baihatXYZ").innerHTML;
            
                var thutu = new Number(document.getElementById("listSongKara").options.selectedIndex) + 1;
                 var maxthutu = new Number(document.getElementById("thutu").max);
                var url = "@ViewBag.LoginServer";
            
                  var formData = new FormData();
                        formData.append("url", url);
                        formData.append("index", thutu);
            
            $.ajax({
            url: "/Admin/Karaoke_Ajax_Call",
            type: "POST",
            data: formData,
            contentType: false,
            processData: false,
            success: function(data) {
            
                if (data.error == "true")
                {
                    alert("Đã xảy ra lỗi. Vui lòng thử lại sau!");
                    document.getElementById("baihatXYZ").innerHTML = baihatcu;
                    DungKaraoke();
                    return;
                }
            
               document.getElementById("musix").src = data.mp3_goc;
               document.getElementById("music").src = data.mp3_kara;
               document.getElementById("txtKara").value = data.text_kara;
               document.getElementById("thutu").value = thutu;
               document.getElementById("thutuXYZ").innerHTML = "Huỷ trình phát Karaoke tự động";
               if ('@TempData["ajax_js"]' == "false")
               {
                   document.getElementById("thutuXYZ").innerHTML += " (đã phát : "+ thutu + "/" + maxthutu + ")"
               }
            
               document.getElementById("baihatXYZ").innerHTML = data.tenbaihat;


               var formData = new FormData();
                    formData.append("url", "@ViewBag.LoginServer");
                    formData.append("baihat", data.tenbaihat);
                    formData.append("option", "5");

                     $.ajax({
                        url: "/Admin/GetInfoKaraokeServerForShare",
                        type: "POST",
                        data: formData,
                        contentType: false,
                        processData: false,
                        success: function(data) {
            
                        document.getElementById("linkKara").value = data.result;
                        }});

               document.getElementById("listSongKara").blur();
               resetKaraoke();
            }});
            }
            
            function loadlistSong()
            {
                if (loadxong == 1) return;
            
                var url = "@ViewBag.LoginServer";
                  var formData = new FormData();
                        formData.append("url", url);
            
            $.ajax({
            url: "/Admin/ListSongKaraoke_Call",
            type: "POST",
            data: formData,
            contentType: false,
            processData: false,
            success: function(data) {
            
               var content = data.content;
            
               var listSong = content.split('\n');
            
               document.getElementById("listSongKara").innerHTML = "";
               for (var i  = 0; i < listSong.length; i++)
               {
                   if (listSong[i] == "") continue;

                   document.getElementById("listSongKara").innerHTML += "<option>"+ listSong[i] + "</option>";
               }
               loadxong = 1;
            }});
            }
            
            function StopKaraoke() {
                var url = "@ViewBag.LoginServer";
                var baihat = "@ViewBag.BHServer";
            
                var thongtin = url + "[NONE]" + "-.-" + baihat + "[NONE]" + "-.-[NOT]-.-0";
            
                if ("@ViewBag.Share" != "YES - OK")
                {
                    if ('@TempData["ajax_js"]' == "true" && '@TempData["index-auto"]' != null && '@TempData["index-auto"]' != "")
                    {
                var thutu = new Number(document.getElementById("thutu").value);
                var maxthutu = new Number(document.getElementById("thutu").max);
            
                                if (thutu + 1 <= maxthutu)
                                thutu = thutu + 1;
                                else
                                thutu = 1;
            
                        var formData = new FormData();
                        formData.append("url", url);
                        formData.append("index", thutu);
            
            $.ajax({
            url: "/Admin/Karaoke_Ajax_Call",
            type: "POST",
            data: formData,
            contentType: false,
            processData: false,
            success: function(data) {
            
                if (data.error == "true")
                {
                    alert("Đã xảy ra lỗi. Vui lòng thử lại sau!");
                    DungKaraoke();
                    return;
                }
            
               document.getElementById("musix").src = data.mp3_goc;
               document.getElementById("music").src = data.mp3_kara;
               document.getElementById("txtKara").value = data.text_kara;
               document.getElementById("thutu").value = thutu;
               document.getElementById("thutuXYZ").innerHTML = "Huỷ trình phát Karaoke tự động";
               if ('@TempData["ajax_js"]' == "false")
               {
                   document.getElementById("thutuXYZ").innerHTML += " (đã phát : "+ thutu + "/" + maxthutu + ")"
               }
               document.getElementById("baihatXYZ").innerHTML = data.tenbaihat;

               if ('@TempData["ajax_js"]' == "false")
               {
                var formData = new FormData();
                    formData.append("url", "@ViewBag.LoginServer");
                    formData.append("baihat", data.tenbaihat);
                    formData.append("option", "5");

                     $.ajax({
                        url: "/Admin/GetInfoKaraokeServerForShare",
                        type: "POST",
                        data: formData,
                        contentType: false,
                        processData: false,
                        success: function(data) {
            
                        document.getElementById("linkKara").value = data.result;
                        }});
                }

               document.getElementById("listSongKara").options.selectedIndex = thutu - 1;
               resetKaraoke();
            }});
            
                        return;
                    }
                    window.location.href = "/Home/XoaKaraoke?id=" + thongtin + "&&ip=" + '@TempData["userIP"]';
                }
                else 
                {
                      window.location.href = "/Home/XoaKaraoke" + "?ip=" + '@TempData["userIP"]';
                }
            }
            
            function DungKaraoke() {
                var url = "@ViewBag.LoginServer";
                var baihat = "@ViewBag.BHServer";
            
                var thongtin = url + "[NONE]" + "-.-" + baihat + "[NONE]" + "-.-[NOT]-.-0";
            
                if ("@ViewBag.Share" != "YES - OK") window.location.href = "/Home/XoaKaraoke?id=" + thongtin + "&&cancel=true";
                else window.location.href = "/Home/XoaKaraoke?cancel=true";
            }
            
            var time_xuathien = [];
            var time_luuvet = [];
            
            var h_xh = [];
            var h_le = [];
            
            var so = 0;
            
            var mau = "#2900f5";
            var mauX = "#efe6e6";
            var kieuchu = 0;
            var kieudemnguoc = "N";
            
            function doimau() {
                mau = document.getElementById("mau").value;
                document.getElementById("xemthumau").style.color = mau;
                document.getElementById("xanhX1").style.setProperty("--color", mau);
                document.getElementById("xanhX2").style.setProperty("--color", mau);
            }
            
            function doimaunex_Save() {
                if (localStorage.getItem("maunex") == null
                ||  document.getElementById("maunex") == null) return;
            
                document.getElementById("maunex").value = localStorage.getItem("maunex");
            }
            
            function doianhmo_Save() {
                if (localStorage.getItem("anhmo") == null
                ||  document.getElementById("anhmo") == null) return;
            
                document.getElementById("anhmo").value = localStorage.getItem("anhmo");
            }
            
            function doimaunen_Save() {
                if (localStorage.getItem("maunen") == null || '@TempData["codinh"]' == "true"
                ||  document.getElementById("maunenX") == null) return;
            
                if (localStorage.getItem("maunen") != "none" && localStorage.getItem("maunen") != "blue") {
                    var maunen = localStorage.getItem("maunen");
                    document.getElementById("maunenX").value = maunen;
            
                    doimaunenX();
                } else if (localStorage.getItem("maunen") == "none") {
                    useMauNen = 2;
                    xoamaunen();
                } else if (localStorage.getItem("maunen") == "blue") {
                    xoamaunen();
                }
            }
            
            function doimau_Save() {
                if (localStorage.getItem("mau") == null
                 || document.getElementById("mau") == null || document.getElementById("xanhX1") == null || document.getElementById("xanhX2") == null ||  document.getElementById("xemthumau") == null) return;
            
                mau = localStorage.getItem("mau");
                document.getElementById("mau").value = mau;
            
                document.getElementById("xemthumau").style.color = mau;
                document.getElementById("xanhX1").style.setProperty("--color", mau);
                document.getElementById("xanhX2").style.setProperty("--color", mau);
            }
            
            function doimauX() {
                mauX = document.getElementById("mauX").value;
                document.getElementById("xemmauthu").style.color = mauX;
                //-- document.getElementById("txtKaraoke1").style.color = document.getElementById("mauX").value;
                //-- document.getElementById("txtKaraoke2").style.color = document.getElementById("mauX").value;
                document.getElementById("xanhX1").style.setProperty("--colox", mauX);
                document.getElementById("xanhX2").style.setProperty("--color", mauX);
            }
            
            function doimauX_Save() {
                if (localStorage.getItem("mauX") == null
                || document.getElementById("mauX") == null || document.getElementById("xanhX1") == null || document.getElementById("xanhX2") == null ||  document.getElementById("xemmauthu") == null) return;
  
                mauX = localStorage.getItem("mauX");
                document.getElementById("mauX").value = mauX;
                document.getElementById("xemmauthu").style.color = mauX;
                //-- document.getElementById("txtKaraoke1").style.color = document.getElementById("mauX").value;
                //-- document.getElementById("txtKaraoke2").style.color = document.getElementById("mauX").value;
                document.getElementById("xanhX1").style.setProperty("--colox", mauX);
                document.getElementById("xanhX2").style.setProperty("--color", mauX);
            }
            
            function doimauY_Save() {
                if (localStorage.getItem("mauY") == null
                || document.getElementById("mauY") == null || document.getElementById("xemmaudi") == null || document.getElementById("number") == null) return;
            
                document.getElementById("mauY").value = localStorage.getItem("mauY");
                document.getElementById("xemmaudi").style.color = localStorage.getItem("mauY");
                document.getElementById("number").style.color = localStorage.getItem("mauY");
            }
            
            function doimauY() {
                document.getElementById("xemmaudi").style.color = document.getElementById("mauY").value;
                document.getElementById("number").style.color = document.getElementById("mauY").value;
            }
            
            // function doidotre_Save()
            //{
            //    if (localStorage.getItem("dotre") == null)
            //    return;
            
            //     dotre = localStorage.getItem("dotre");
            //     document.getElementById("dotre").value = dotre;
            //}
            
            function doikieuchu_Save() {
                if (localStorage.getItem("kieuchu") == null
                ||  document.getElementById("fontKieu") == null) return;
            
                kieuchu = localStorage.getItem("kieuchu");
            
                var kieuchuLength =  document.getElementById("fontKieu").options.length;
            
                if (kieuchu >= kieuchuLength)
                {
                    kieuchu = 0;
                    localStorage.setItem("kieuchu", 0);
                }
            
                document.getElementById("fontKieu").options.selectedIndex = kieuchu;
            }
            
            function doiFontKieu() {
                var index = document.getElementById("fontKieu").options.selectedIndex;
                var kieuchu = document.getElementById("fontKieu").options[index].value;
            
                document.getElementById("txtKaraoke1").style.fontFamily = kieuchu;
                document.getElementById("txtKaraoke2").style.fontFamily = kieuchu;
            }
            
            // function doidotre()
            //{
            //    var dotre = document.getElementById("dotre").value;
            //    if (isNaN(dotre))
            //    {
            //        dotre = "0.3";
            //        document.getElementById("dotre").value = dotre;
            //    }
            //}
            
            function doikieudemnguoc() {
                var kieudemnguoc = document.getElementById("kieudemnguoc").value;
                var kt = new Number(document.getElementById("kichthuoc").value);
                if (kieudemnguoc == "N" || kieudemnguoc == "") {
                    kieudemnguoc = "N";
                    document.getElementById("kieudemnguoc").value = kieudemnguoc;
                    document.getElementById("number").style.fontSize = kt + "px";
                } else {
                    document.getElementById("number").style.fontSize = kt / 2 + "px";
                }
            }
            
            function doikieudemnguoc_Save() {
                if (localStorage.getItem("kieudemnguoc") == null
                ||  document.getElementById("kieudemnguoc") == null) return;
            
                kieudemnguoc = localStorage.getItem("kieudemnguoc");
                document.getElementById("kieudemnguoc").value = kieudemnguoc;
            }
            
            var LBH;
            var flg = 0;
            
            var loadover = 0;
            var flix = 0;
            
            var id = setInterval(myAlert, 100);
            
            var ndTK = '@TempData["TK-KARA"]'.replaceAll("&#xA;", "\n").split("\n");
            
            var nanFirst = 0;
            
            function myAlert() {
                if (flag == 0) {
                    LBH = document.getElementById("txtKara").value.split(/\r|\n/);
            
                    //             if (dFlag == 0 && LBH.length == 1)
                    //            {
                    //                 document.getElementById("message").style.display = "block";
                    //  document.getElementById("error").style.display = "block";
                    //document.getElementById("error").innerHTML = "⚠️ Cảnh báo, hệ thống không nhận diện được dữ liệu và nội dung Karaoke của bạn. Nguyên nhân có thể do bản text Karaoke của bạn đã tải lên có nội dung được mã hoá, vui lòng thử giải mã và thực hiện lại !";
                    //              dFlag = 1;
                    //            }
            
                    var k = 0;
                    for (var i = 0; i < LBH.length; i++) {
                        var ss = LBH[i].split("#");
                        time_xuathien[k] = new Number(ss[0]);
                        LBH[k] = ss[1];
                        if (ss[1] != "[Empty]" && ss[1] != "[Empty-X]") {
                            time_luuvet[k] = ss[2];
                        }
                        k++;
                    }
            
                    flag = 1;
                }
            
                if (flix == 0) {
                    var height = screen.height;
                    var width = screen.width;
            
                    var kichthuoc = new Number(width / 19).toFixed();
                    var vitri = new Number(height / 170).toFixed();
            
                    if ('@TempData["TK-Kara"]' != "" || '@TempData["codinh"]' == "true") {
                        vitri = 0;
                        document.getElementById("hang").value = vitri;
                    }
            
                    if (localStorage.getItem("kichthuoc") == null) {
                        document.getElementById("kichthuoc").value = kichthuoc;
                        doikichthuoc();
                    }
            
                    if ('@TempData["codinh"]' == "false" && localStorage.getItem("hang") == null) document.getElementById("hang").value = vitri;
            
                    flix = 1;
                }
            
                if (you == false || youX == false) return;
            
                if (loadover != 3) {
                    var music = document.getElementById("music").readyState;
                    var musix = document.getElementById("musix").readyState;
                    if (music != 4 || musix != 4) {
                        if ('@TempData["boquathongbao"]' == "false") {
                            document.getElementById("error").style.display = "block";
                            document.getElementById("message").style.display = "block";
                            document.getElementById("loadingX").style.display = "inline-block";
                            document.getElementById("error").innerHTML =
                                "Nội dung karaoke của bạn đang được tải (hãy kiên nhẫn chờ đợi cho đến khi thông báo này được tắt). Lưu ý : bản nhạc sẽ tự động được phát lại ngay sau khi việc load hoàn tất !";
                            notice = 1;
                        }
                        loadover = 1;
                    } else {
                        document.getElementById("loadingX").style.display = "none";
                        if (loadover == 1) {
                            loadover = 2;
                        }
            
                        if (nanFirst == 0 && '@TempData["boquathongbao"]' == "false") {
                            document.getElementById("message").style.display = "block";
                            document.getElementById("error").style.display = "block";
                            document.getElementById("error").innerHTML = 'Xin lỗi vì sự bất tiện : khi lần đầu tiên bạn truy cập vào đây, vui lòng click nút "Khởi động lại" bên dưới sau khi nhạc đã phát được vài giây.<br />Nếu bạn cảm thấy tiến trình chạy màu chữ không kịp tiến độ của lời nhạc thực tế thì hãy thử reset lại mp3 vài lần hoặc kiểm tra/tạo lại bản TXT karaoke của bạn 😁';
                            notice = 1;
                            nanFirst = 1;
                        }
                    }
            
                    if (loadover == 2) {
                        loadover = 3;
                        resetKaraoke();
                    }
                }
            
                if (flg == 0 && '@TempData["R-fontkieu"]' != "" && '@TempData["R-fontKieu"]' != "") {
                    //if ('@TempData["R-hang"]' != null && '@TempData["R-hang"]' != "")
                    //{
                    //    var hangR = '@TempData["R-hang"]';
                    //    document.getElementById("hang").value = hangR;
            
                    //                             var hax = "";
                    //    for (var i  =0; i < hangR; i++)
                    //    hax += "<br>";
            
                    //    document.getElementById("hienthi").innerHTML = hax;
                    //}
            
                    if ('@TempData["R-mau"]' != null && '@TempData["R-mau"]' != "") {
                        var mauR = "#" + '@TempData["R-mau"]';
                        mau = mauR;
                        document.getElementById("mau").value = mauR;
            
                        document.getElementById("xemthumau").style.color = mauR;
                        //document.getElementById("xanhX1").style.setProperty("--color", mauR);
                        //document.getElementById("xanhX2").style.setProperty("--color", mauR);
                    }
            
                    document.getElementById("mauX").value = "#" + '@TempData["R-mauX"]';
                    document.getElementById("xemmauthu").style.color = "#" + '@TempData["R-mauX"]';
                    //document.getElementById("xanhX1").style.setProperty("--colox", "#"+'@TempData["R-mauX"]');
                    mauX = "#" + '@TempData["R-mauX"]';
                    // document.getElementById("xanhX2").style.setProperty("--color", "#"+'@TempData["R-mauX"]');
            
                    document.getElementById("mauY").value = "#" + '@TempData["R-mauY"]';
                    document.getElementById("xemmaudi").style.color = "#" + '@TempData["R-mauY"]';
                    document.getElementById("number").style.color = "#" + '@TempData["R-mauY"]';
            
                    //   document.getElementById("kichthuoc").value = '@TempData["R-kichthuoc"]';
                    //   var kt = '@TempData["R-kichthuoc"]' + "px";
                    //  document.getElementById("txtKaraoke1").style.fontSize = kt;
                    //document.getElementById("txtKaraoke2").style.fontSize = kt;
                    //document.getElementById("number").style.fontSize = kt;
            
                    document.getElementById("fontKieu").options.selectedIndex = new Number('@TempData["R-fontkieu"]');
                    doiFontKieu();
            
                    document.getElementById("demnguockieu").innerHTML = '@TempData["R-kieudemnguoc"]';
                    document.getElementById("kieudemnguoc").value = document.getElementById("demnguockieu").innerHTML;
                    kieudemnguoc = '@TempData["R-kieudemnguoc"]';
                    doikieudemnguoc();
            
                    document.getElementById("maunex").value = "#" + '@TempData["R-maunex"]';
                    document.getElementById("anhmo").value = '@TempData["R-anhmo"]';
                    moanh();
                    flg = 1;
                }
            
                // Thay doi tu cai dat da luu
                if (flg == 0 && "@ViewBag.Share" != "YES - OK") {
                    doimau_Save();
                    doihang_Save();
                    doimauX_Save();
                    doimauY_Save();
                    doikichthuoc_Save();
                    doikieuchu_Save();
                    doiFontKieu();
                    doikieudemnguoc_Save();
                    doikieudemnguoc();
                    // doidotre_Save();
            
                    doimaunen_Save();
                    doimaunex_Save();
                    doianhmo_Save();
                    moanh();
            
                    flg = 1;
                }
            
                if (t % 5 == 0) {
                    if (!window.screenTop && !window.screenY) {
                        document.getElementById("xanh").innerHTML = "<b>FULL MÀN HÌNH - OFF</b>";
                        var menu = document.getElementById("menu");
                        var hienlinh = document.getElementById("hienlinh");
            
                        const detectDeviceType = () =>
                            // Use a regular expression to test the userAgent string for common mobile device identifiers.
                            /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)
                                ? "Mobile" // If any of the identifiers are found, return 'Mobile'.
                                : "Desktop"; // Otherwise, return 'Desktop'.
            
                        //if (detectDeviceType() == "Desktop" && menu.style.display != "block") {
                        //    menu.style.display = "block";
                        //    hienlinh.style.display = "none";
                        //}
                    } else document.getElementById("xanh").innerHTML = "<b>FULL MÀN HÌNH - ON</b>";
                }
            
                t++;
            
                if (t == 15 && flix == 0) {
                    resetKaraoke();
                    resetKaraoke();
                    resetKaraoke();
            
                    flix = 1;
                }
            
                //if (h_xh[kf] !== undefined)
                //{
                //     if (h_xh[kf+1] === undefined)
                //    {
                //        so = time_xuathien[n] - h_xh[kf];
                //    }
                //    else
                //    {
                //       so = h_xh[kf+1] - h_xh[kf];
                //    }
                //}
            
                document.getElementById("thietkeKara").style.fontSize = document.getElementById("kichthuoc").value + "px";
            
                if (t == time_xuathien[n]) {
                    h_xh = [];
                    h_le = [];
            
                    if (LBH[n] != "[Empty]" && LBH[n] != "[Empty-X]") {
                        var s = time_luuvet[n].split(",");
            
                        for (var i = 0; i < s.length; i++) {
                            var ss = s[i].split("-");
                            h_xh[kk] = new Number(ss[0]);
                            h_le[kk] = new Number(ss[1]);
                            kk++;
                        }
            
                        if ('@TempData["TK-KARA"]' != "") {
                            var x = ndTK[ix % ndTK.length].split("=");
                            if (x[0] == time_xuathien[n] + "") {
                                document.getElementById("mau").value = x[2];
                                mau = document.getElementById("mau").value;
                                document.getElementById("thietkeKara").innerHTML = x[1];
                                document.getElementById("thietkeKara").style.color = x[2];
            
                                //Check member is has singer
            
                                if ('@TempData["casi"]' == "true") {
                                    if ('@TempData["hassinger"]' == "true") {
                                        if (x[1] == "[SINGER]") {
                                            document.getElementById("thietkeKara").innerHTML = "";
                                            document.getElementById("chon").options.selectedIndex = 1;
                                            changeKara();
                                        } else {
                                            document.getElementById("chon").options.selectedIndex = 0;
                                            changeKara();
                                        }
                                    }
                                }
            
                                ix++;
                            }
                        }
                    }
            
                    document.getElementById("txtKaraoke1").innerHTML = '<span id="xanhX1" class="word"></span>';
                    document.getElementById("txtKaraoke2").innerHTML = '<span id="xanhX2" class="work"></span>';
            
                    $("#xanhX2").addClass("work").attr("data-content", "");
                    $("#xanhX1").addClass("word").attr("data-content", "");
            
                    if ('@TempData["TK-KARA"]' != "" && LBH[n] == "\t*") {
                        document.getElementById("thietkeKara").innerHTML = "";
                    }
            
                    if (LBH[n] == "[Empty]" || LBH[n] == "[Empty-X]") {
                        document.getElementById("txtKaraoke1").innerHTML = "";
                        document.getElementById("txtKaraoke2").innerHTML = "";
                        document.getElementById("txtKara1").value = "";
                        document.getElementById("txtKara2").value = "";
                        if ('@TempData["TK-KARA"]' != "") document.getElementById("thietkeKara").innerHTML = "";
                    } else {
                        var sing = LBH[n].split("*");
            
                        //-- document.getElementById("txtKaraoke1").innerHTML = new String(sing[0]).toUpperCase().replace("UNDEFINED","").replace("undefined","");
            
                        //-- document.getElementById("txtKaraoke2").innerHTML = new String(sing[1]).toUpperCase().replace("UNDEFINED","").replace("undefined","");
            
                        var word1 = document.getElementById("xanhX1");
                        word1.style.setProperty("--colox", mauX);
                        word1.style.setProperty("--color", mau);
                        var xuan1 = new String(sing[0]).replace("UNDEFINED", "").replace("undefined", "");
            
                        if ('@TempData["inhoa"]' == "true") xuan1 = xuan1.toUpperCase();
            
                        word1.innerHTML = xuan1;
            
                        var word2 = document.getElementById("xanhX2");
                        word2.style.setProperty("--colox", mauX);
                        word2.style.setProperty("--color", mau);
                        var xuan2 = new String(sing[1]).replace("UNDEFINED", "").replace("undefined", "");
            
                        if ('@TempData["inhoa"]' == "true") xuan2 = xuan2.toUpperCase();
            
                        word2.innerHTML = xuan2;
            
                        document.getElementById("txtKara1").value = sing[0];
                        document.getElementById("txtKara2").value = sing[1];
                    }
            
                    //txtKaraoke1.Select(0, LBH[n].Length + 1);
                    //txtKaraoke1.SelectionColor = Color.White;
                    //txtKaraoke2.Select(0, LBH[n].Length + 1);
                    //txtKaraoke2.SelectionColor = Color.White;
                    n++;
            
                    //  so1 = h_xh[kf];
                    // so2 = h_xh[kf + (sing[0].split(' ').length -1)];
                    // so1X = h_xh[kf + sing[0].split(' ').length];
                    //so2X = h_xh[kf + (sing[0].split(' ').length + sing[1].split(' ').length - 1)];
                    // so2X = time_xuathien[n];
            
                    //so = (h_xh[kf+1] - h_xh[kf])/2.8;
            
                    // var so0 = h_xh[kf-1];
            
                    //       var so1 = h_xh[kf];
                    //       var so2 = 0;
                    //       if (h_xh[kf+1] === undefined || h_xh[kf+1] == null)
                    //       so2 = time_xuathien[n];
                    //       else
                    //       so2 = h_xh[kf+1];
            
                    //       var nan = 0.3;
            
                    //       if (so2 - so1 >= 15)
                    //       nan = 1;
            
                    //       // document.getElementById("message").style.display = "block";
                    //  document.getElementById("error").style.display = "block";
                    //document.getElementById("error").innerHTML = (so2 - so1) + " - "+so1+ " - "+so2;
            
                    //       so = ((so2 - so1) /10) + nan;
            
                    //if (so2 - so1 < 3)
                    // so = 0.3;
                    // else
                    // if (so2 - so1 < 7)
                    // so = 0.8;
                    // else
                    // if (so2 - so1 < 10)
                    // so = 1.3;
                    //  else
                    // if (so2 - so1 < 13)
                    // so = 1.8;
                    //  else
                    // if (so2 - so1 < 16)
                    // so = 2.3;
                    //  else
                    // if (so2 - so1 < 19)
                    // so = 2.8;
                    // else
                    // if (so2 - so1 < 22)
                    // so = 3.3;
                    //  else
                    // if (so2 - so1 < 25)
                    // so = 3.8;
                    //  else
                    // if (so2 - so1 < 28)
                    // so = 4.3;
                    //  else
                    // so = 4.8;
            
                    //soA = (so2 - so1) / 3.2;
                    //soB = (so2X - so1X) / (90/13);
                    //alert(h_xh[0] +" - "+ h_xh[1] +" - "+ h_xh[2]+" - " + h_xh[3]+" - " + h_xh[4]);
                }
            
                var so1 = h_xh[kf];
                var so2 = 0;
                if (h_xh[kf + 1] === undefined || h_xh[kf + 1] == null) so2 = time_xuathien[n];
                else so2 = h_xh[kf + 1];
            
                var nan = 0.3;
            
                so = (so2 - so1) / 10;
            
                if (n > 1 && LBH[n - 1] == "[Empty]" && empty == -1) {
                    empty = kf;
                }
            
                if (LBH[n - 3] == "[Empty]") empty = -1;
            
                if ((t >= h_xh[0] - 28 && t <= h_xh[0] - 1) || (t >= h_xh[empty] - 28 && t <= h_xh[empty] - 1)) {
                    var hang = new Number(document.getElementById("hang").value);
                    var hax = "";
                    for (var i = 0; i < hang - 5; i++) hax += "<br>";
            
                    document.getElementById("hienthi").innerHTML = hax;
                } else doihang();
            
                if (h_xh != null && (t == h_xh[0] - 8 || (empty != -1 && t == h_xh[empty] - 8))) {
                    var xa = document.getElementById("kieudemnguoc").value;
                    if (xa == "N") document.getElementById("number").innerHTML = "1";
                    else document.getElementById("number").innerHTML = xa;
                }
            
                if (h_xh != null && (t == h_xh[0] - 18 || (empty != -1 && t == h_xh[empty] - 18))) {
                    var xa = document.getElementById("kieudemnguoc").value;
                    if (xa == "N") document.getElementById("number").innerHTML = "2";
                    else document.getElementById("number").innerHTML = xa + " " + " " + xa;
                }
            
                if (h_xh != null && (t == h_xh[0] - 28 || (empty != -1 && t == h_xh[empty] - 28))) {
                    var xa = document.getElementById("kieudemnguoc").value;
                    if (xa == "N") document.getElementById("number").innerHTML = "3";
                    else document.getElementById("number").innerHTML = xa + " " + " " + xa + " " + xa;
                }
            
                var xinloi = document.getElementById("txtKara1").value.split(" ");
            
                var kara1 = document.getElementById("txtKara1").value;
                var kara2 = document.getElementById("txtKara2").value;
            
                if (h_xh != null && t == h_xh[kf]) {
                    if (h_le[kf] <= kara1.length + xinloi[xinloi.length - 1].length) {
                        var ct1 = kara1.substring(0, h_le[kf]).replace("UNDEFINED", "").replace("undefined", "");
            
                        if ('@TempData["inhoa"]' == "true") ct1 = ct1.toUpperCase();
            
                        var ct2 = kara1
                            .substring(h_le[kf], h_le[kf + 1])
                            .replace("UNDEFINED", "")
                            .replace("undefined", "");
            
                        if ('@TempData["inhoa"]' == "true") ct2 = ct2.toUpperCase();
            
                        var ct3 = kara1
                            .substring(h_le[kf + 1], kara1.length)
                            .replace("UNDEFINED", "")
                            .replace("undefined", "");
            
                        if ('@TempData["inhoa"]' == "true") ct3 = ct3.toUpperCase();
            
                        if (ct3 != "" && ct2 != "") ct2 = ct2.replace(" ", "");
            
                        document.getElementById("txtKaraoke1").innerHTML = '<span style="color:' + mau + '">' + ct1 + '</span><span id="xanhX1" class="word">' + ct2 + '</span>&nbsp;<span style="color:' + mauX + '">' + ct3 + "</span>";
                        var word1 = document.getElementById("xanhX1");
            
                        $("#xanhX1").addClass("word").attr("data-content", ct2.replace(" ", ""));
                        $("#xanhX2").addClass("work").attr("data-content", "");
            
                        word1.style.setProperty("--color", mau);
                        word1.style.setProperty("--colox", mauX);
                        word1.style.setProperty("--animation", so + "s");
                    } else {
                        var ct1 = kara2
                            .substring(0, h_le[kf] - kara1.length - 2)
                            .replace("UNDEFINED", "")
                            .replace("undefined", "")
                            .trim();
            
                        if ('@TempData["inhoa"]' == "true") ct1 = ct1.toUpperCase().trimEnd();
            
                        var ct2 = kara2
                            .substring(h_le[kf] - kara1.length - 2, h_le[kf + 1] - kara1.length - 2)
                            .replace("UNDEFINED", "")
                            .replace("undefined", "")
                            .trim();
            
                        if ('@TempData["inhoa"]' == "true") ct2 = ct2.toUpperCase().trimEnd();
            
                        var ct3 = kara2
                            .substring(h_le[kf + 1] - kara1.length - 2, kara2.length)
                            .replace("UNDEFINED", "")
                            .replace("undefined", "")
                            .trim();
            
                        if ('@TempData["inhoa"]' == "true") ct3 = ct3.toUpperCase().trimEnd();
            
                        if (ct1.length == kara2.length) {
                            ct2 = "";
                            ct3 = "";
                        }
            
                        if (h_le[kf + 1] == null || h_le[kf + 1] === undefined)
                            document.getElementById("txtKaraoke2").innerHTML =
                                '&nbsp;&nbsp;<span style="color:' + mau + '">' + ct1 + '</span>&nbsp;<span id="xanhX2" class="work">' + ct2.replace(" ", "") + '</span>&nbsp;<span style="color:' + mauX + '">' + ct3 + "</span>";
                        else if (h_le[kf + 2] == null || h_le[kf + 2] === undefined)
                            document.getElementById("txtKaraoke2").innerHTML =
                                '&nbsp;<span style="color:' + mau + '">' + ct1 + '</span>&nbsp;<span id="xanhX2" class="work">' + ct2.replace(" ", "") + '</span>&nbsp;<span style="color:' + mauX + '">' + ct3 + "</span>";
                        else
                            document.getElementById("txtKaraoke2").innerHTML =
                                '<span style="color:' + mau + '">' + ct1 + '</span>&nbsp;<span id="xanhX2" class="work">' + ct2.replace(" ", "") + '</span>&nbsp;<span style="color:' + mauX + '">' + ct3 + "</span>";
            
                        var word1 = document.getElementById("xanhX2");
            
                        $("#xanhX2").addClass("work").attr("data-content", ct2.replace(" ", ""));
                        $("#xanhX1").addClass("word").attr("data-content", "");
            
                        word1.style.setProperty("--color", mau);
                        word1.style.setProperty("--colox", mauX);
                        word1.style.setProperty("--animation", so + "s");
                    }
                    kf++;
            
                    document.getElementById("number").innerHTML = "";
                }
            }
            
            function democheck() {
                if (document.getElementById("checkdemo").checked == false) {
                    document.getElementById("phan1").style.display = "block";
                    document.getElementById("phan2").style.display = "block";
                    document.getElementById("phan3").style.display = "block";
                    document.getElementById("servercheck").style.display = "block";
                } else {
                    document.getElementById("phan1").style.display = "none";
                    document.getElementById("phan2").style.display = "none";
                    document.getElementById("phan3").style.display = "none";
                    document.getElementById("servercheck").style.display = "none";
                }
            }
            
            function moanh() {
                var x = document.getElementById("myVideo");
            
                if ("@ViewBag.SuDung" == "Video") {
                    x = document.getElementById("myVidex");
                }
            
                var so = new Number(document.getElementById("anhmo").value);
            
                if (so == undefined) {
                    document.getElementById("anhmo").value = "1";
                    so = 1;
                }
            
                if (so > 1 || so < 0) {
                    document.getElementById("anhmo").value = "1";
                    so = 1;
                }
            
                x.style.opacity = so;
                document.getElementById("bodix").style.backgroundColor = document.getElementById("maunex").value;
            }
        </script>
        <audio id="muteplay" autoplay hidden onplaying="ketquaplay()" onpause="playketqua()" onended="playketqua()" muted>
            <source src="/karaoke_Example/ExamKara/KaraokeDemo.mp3" type="audio/mpeg" />
        </audio>
        @if (ViewBag.Share != "YES" && ViewBag.Share != "ERROR") {
        <audio id="music" autoplay hidden onplay="PlayKaraoke()" onplaying="PlayY()" onpause="PlayXKaraoke()" onended="StopKaraoke()">
            <source src="@ViewBag.Music" type="audio/mpeg" />
        </audio>
        <audio id="musix" autoplay hidden muted onplay="ToPlayKaraoke()" onplaying="PlayZ()" onpause="PlayXKaraokeX()" onended="StopKaraoke()">
            <source src="@ViewBag.Musix" type="audio/mpeg" />
        </audio>
        <textarea id="txtKara" hidden>@ViewBag.Karaoke</textarea>
        <input type="text" id="linkKara" style="display: none;" value="@ViewBag.LinkKaraoke" />
        @if (ViewBag.Music == "") { @if (ViewBag.Karaoke == "karaoke") {
        <h3 style="color: aqua;">
            Bạn nên trải nghiệm tính năng này trên máy tính (PC), laptop,... nhé 😄<br />
            Lưu ý : trong khi đang trải nghiệm Karaoke, bạn không nên refresh lại trang để tránh mất dữ liệu!
        </h3>
        <br />
        }
        <h2>@Html.ActionLink("Bạn có muốn trải nghiệm phiên bản Karaoke cơ bản?", "PlayKaraoke")</h2>
        <br />
        <br />
        <table align="center">
            <h2 style="text-align: center;">Play Your Karaoke - Online (<span style="color: orange;">phiên bản thường</span>)</h2>
            <br />
            @using (Html.BeginForm("ToPlayKaraoke", "Home", FormMethod.Post, new { @enctype = "multipart/form-data" })) { @Html.ValidationSummary(true)
            <input type="text" id="linkKara" name="LinkKaraoke" style="display: none;" value="@ViewBag.LinkKaraoke" />
            @if (ViewBag.ListSong == null || ViewBag.ListSong.Length == 0) {
            <tr style="height: 40px;">
                <td></td>
                <td>
                    <br />
                    <b id="check" style="color: orangered;"><input id="checkdemo" onchange="democheck()" type="checkbox" name="txtChon" /> Tham khảo bản karaoke demo có sẵn trên hệ thống</b>
                    <br />
                </td>
            </tr>
            } @if (ViewBag.ListSong == null || ViewBag.ListSong.Length == 0) {
            <tr style="height: 40px;">
                <td></td>
                <td>
                    <br />
                    <b id="servercheck" style="color: hotpink;">
                    <input id="onlineServer" onchange="onlinecheck()" type="checkbox" name="txtOnlineServer" />
                    Sử dụng host server Karaoke online của bạn (mệt mỏi vì mỗi lần phải upload các file từ local 😀)
                    </b>
                    <br />
                </td>
            </tr>
            <tr style="height: 40px;">
                <td></td>
                <td id="phan4" style="display: none;">
                    <br />
                    <b> Nhập host Server name Karaoke của bạn : </b> <a href="#xuly" onclick="helpKara()" style="color: crimson;">Hướng dẫn tạo host Server để play Karaoke của bạn</a>
                    <br />
                    <input type="text" id="serverX" name="txtServer" size="80" placeholder="" value="@ViewBag.Server" />
                    <br />
                    <span style="color: red;">Nếu bạn không nhập, hệ thống sẽ tự động cho bạn trải nghiệm host server Karaoke mẫu có sẵn của chúng tôi.</span>
                    <br />
                </td>
            </tr>
            <tr style="height: 40px;">
                <td></td>
                <td id="phan5" style="display: none;">
                    <br />
                    <b> Nhập bài hát Karaoke từ host server của bạn (lưu ý nhập chính xác) : </b>
                    <br />
                    <input id="baihatX" type="text" name="txtSong" size="80" placeholder="" value="@ViewBag.BaiHatSV" />
                    <br />
                </td>
            </tr>
            <textarea id="songlist" hidden>@ViewBag.ListSong</textarea>
            <tr style="height: 40px;">
                <td></td>
                <td id="phan6" style="display: none;">
                    <br />
                    <b style="color: aqua;">
                    Bật mí tại thư mục root trên host server của bạn, bạn có thể tạo file <span style="color: deeppinkgreen;">MyListSong.txt</span>, trong đó liệt kê các bài hát Karaoke (thư mục) đang tồn tại trên host server của bạn,
                    mỗi bài hát phân biệt và cách nhau bởi kí tự Enter :
                    </b>
                    <a href="#xuly" onclick="showlist()" style="color: crimson;" id="getlist">Get all list song of your host server</a>
                    &nbsp;||&nbsp; @if (ViewBag.Share != null && ViewBag.Share != "" && ViewBag.Share != "ERROR") {
                    <a href="#xuly" style="color: red;" onclick="playAutoList()">Play Karaoke (tự động) theo thứ tự của list song</a>
                    <input hidden type="checkbox" id="autoSong" name="txtAutoSong" />
                    }
                    <br />
                    <br />
                </td>
            </tr>
            } else {
            <tr style="height: 40px;">
                <td></td>
                <td>
                    <br />
                    <b id="servercheck" style="color: hotpink;" hidden>
                    <input id="onlineServer" checked onchange="onlinecheck()" type="checkbox" name="txtOnlineServer" />
                    Sử dụng host server Karaoke online của bạn (mệt mỏi vì mỗi lần phải upload các file từ local 😀)
                    </b>
                    <a href="#xuly" onclick="thoatServer()" style="color: hotpink;">THOÁT CHỨC NĂNG KARAOKE - YOUR HOST SERVER</a>
                    <br />
                </td>
            </tr>
            <tr style="height: 40px;">
                <td></td>
                <td id="phan4" style="display: block;">
                    <br />
                    <b> Nhập host Server name Karaoke của bạn : </b> <a href="#xuly" onclick="helpKara()" style="color: crimson;">Hướng dẫn tạo host Server để play Karaoke của bạn</a>
                    <br />
                    <input readonly type="text" id="serverX" name="txtServer" size="80" placeholder="" value="@ViewBag.Server" />
                    <br />
                </td>
            </tr>
            <tr style="height: 40px;">
                <td></td>
                <td id="phan5" style="display: block;">
                    <br />
                    <b> Nhập bài hát Karaoke từ host server của bạn (lưu ý nhập chính xác) : </b>
                    <br />
                    <input id="baihatX" type="text" name="txtSong" size="80" placeholder="" value="@ViewBag.BaiHatSV" />
                    <br />
                </td>
            </tr>
            <textarea id="songlist" hidden>@ViewBag.ListSong</textarea>
            <tr style="height: 40px;">
                <td></td>
                <td id="phan6" style="display: block;">
                    <br />
                    <b style="color: aqua;">
                    Bật mí tại thư mục root trên host server của bạn, bạn có thể tạo file <span style="color: deeppinkgreen;">MyListSong.txt</span>, trong đó liệt kê các bài hát Karaoke (thư mục) đang tồn tại trên host server của bạn,
                    mỗi bài hát phân biệt và cách nhau bởi kí tự Enter :
                    </b>
                    <a id="getlist" href="#xuly" onclick="showlist()" style="color: crimson;">Get all list song of your host server (click try again to finish)</a>
                    &nbsp;||&nbsp; @if (ViewBag.Share != null && ViewBag.Share != "" && ViewBag.Share != "ERROR") {
                    <a href="#xuly" style="color: red;" onclick="playAutoList()">Play Karaoke (tự động) theo thứ tự của list song</a>
                    <input hidden type="checkbox" id="autoSong" name="txtAutoSong" />
                    }
                    <br />
                    <br />
                    <b id="soluongSong" style="color: chartreuse;"></b>
                    <br />
                    <span style="color: orangered;"><u>Lưu ý</u> : Danh sách bên dưới có thể chưa được hoàn tất do file <span style="color: deeppinkgreen;">MyListSong.txt</span> trên host server của bạn chưa được cập nhật !</span>
                    <br />
                    <br />
                    <select id="listsong" size="10" onclick="changesong()" onchange="changesong()">
                        <option></option>
                    </select>
                    <br />
                </td>
            </tr>
            } @if (ViewBag.ListSong == null || ViewBag.ListSong.Length == 0) {
            <tr style="height: 40px;">
                <td></td>
                <td id="phan1">
                    <br />
                    <b> Tải file TXT karaoke (đã xử lý) || hoặc nhập url *.txt online (khuyến khích) : </b>
                    <br />
                    @if(TempData["fileSuDung"] == "true")
                    {
                    <input type="file" name="txtKaraoke" />
                    }
                    else
                    {
                    <input disabled type="file" name="txtKaraoke" />
                    }
                    &nbsp;&nbsp;
                    @if (TempData["ajax_on_no_upload"] == null || TempData["ajax_on_no_upload"] == "")
                                {
                                    <input size="100" type="text" name="txtKaraoke1" />
                                }
                    <br />
                    <b>@Html.ActionLink("Bạn chưa có file text karaoke?","CreateFile_Karaoke")</b><br />
                    <b style="color: darkgreen;">@Html.ActionLink("Phân đoạn hát cho các member? (sau khi bạn đã tạo file text Karaoke từ hệ thống)","PhanDoanMember_Karaoke")</b>
                    <br />
                </td>
            </tr>
            <tr style="height: 40px;">
                <td></td>
                <td id="phan2">
                    <br />
                    <b> Tải file MP3 karaoke - nhạc gốc có giọng ca sĩ (đã xử lý) || hoặc nhập url *.mp3 online (khuyến khích) : </b>
                    <br />
                    @if(TempData["fileSuDung"] == "true")
                    {
                    <input type="file" name="txtMusix" />
                    }
                    else
                    {
                    <input disabled type="file" name="txtMusix" />
                    }
                    &nbsp;&nbsp;
                    @if (TempData["ajax_on_no_upload"] == null || TempData["ajax_on_no_upload"] == "")
                                {
                                    <input size="100" type="text" name="txtMusix1" />
                                }
                    <br />
                </td>
            </tr>
            <tr style="height: 40px;">
                <td></td>
                <td id="phan3">
                    <br />
                    <b> Tải file MP3 karaoke - nhạc beat tách giọng ca sĩ (karaoke - đã xử lý) || hoặc nhập url *.mp3 online (khuyến khích) : </b>
                    <br />
                    @if(TempData["fileSuDung"] == "true")
                    {
                    <input type="file" name="txtMusic" />
                    }
                    else
                    {
                    <input disabled type="file" name="txtMusic" />
                    }
                    &nbsp;&nbsp;
                    @if (TempData["ajax_on_no_upload"] == null || TempData["ajax_on_no_upload"] == "")
                                {
                                    <input size="100" type="text" name="txtMusic1" />
                                }
                    <br />
                    <span style="color:red">@TempData["ajax_on_no_upload"]</span>
                    <br />
                </td>
            </tr>
            }
            <tr style="height: 40px;">
                <td></td>
                <td>
                    <br />
                    <h5 style="color: brown;">
                        - Sử dụng các app/web bên ngoài để giúp tách nhạc và giọng ca sĩ (nếu bạn không có bản nhạc Karaoke)
                        <br />
                        - Sử dụng các app/web bên ngoài để tăng âm lượng cho âm thanh.
                        <br />
                        - Ngoài ra bạn có thể áp dụng sự hiểu biết về photoshop/hiệu chỉnh âm thanh khác cho thích hợp nhất!
                    </h5>
                </td>
            </tr>
            <tr style="height: 40px;">
                <td></td>
                <td>
                    <select id="chonKara" onchange="chonKaraHay()">
                        <option>Sử dụng ngẫu nhiên ảnh/background có sẵn trên hệ thống - hoặc vòng lặp theo thứ tự</option>
                        <option>Sử dụng link ảnh/background online của bạn</option>
                        <option>Sử dụng link video/background online của bạn</option>
                        <option>Nhập link video Youtube online</option>
                        <option>Lấy ngẫu nhiên link video Youtube hiện có (một số link có thể không còn tồn tại)</option>
                    </select>
                    <input type="number" hidden id="chonKarax" name="KaraChon" value="1" min="1" max="5" style="width: 5em;" />
                    <br />
                    <br />
                    <input name="txtOnline" id="online" size="100" style="display: none;" type="text" placeholder="Nhập link online background của bạn thực hiện karaoke..." />
                    <br />
                    <span id="helpYoutube" style="color: red; display: none;">
                    <u>Lưu ý</u> : một số link Youtube có thể không khả dụng hoặc bạn nên cố gắng thử lại (và hãy tìm video youtube dài phút nhất có thể 😃, tuy nhiên một số trường hợp video có thể tự lặp lại)
                    </span>
                    @*<br />
                    <span id="Youtubehelp" style="color: blueviolet; display: none;">
                    Với lựa chọn này, để đảm bảo sự tuyệt đối thì ban đầu nhạc sẽ không được phát tự động như bình thường.<br />
                    Bạn vui lòng tự canh đợi sau khi video Youtube trên background của bạn đã bắt đầu vừa phát, hãy nhấn phím link <span style="color: orangered;">Play & Start</span> để mới bắt đầu hành trình nhé 😁
                    </span>
                    *@ <br />
                    <br />
                    <input type="checkbox" name="auto_play" />&nbsp;<b>Không tự động phát nhạc khi bắt đầu</b> <br />
                    <br />
                    <input type="checkbox" name="auto_music" />&nbsp;<b>Tự động lặp lại music (không đảm bảo)</b> <br />
                    <br />
                    <input type="checkbox" name="txtBehind" id="behind" />&nbsp;<b>Sẽ bắt đầu phát nhạc sau <input type="number" name="txtBehindNumber" value="10" min="10" max="100" style="width: 5em;" /> giây</b> <br />
                    <br />
                    <input type="checkbox" name="txtInHoa" />&nbsp;<b>Viết in hoa tất cả đoạn Text Karaoke</b> <br />
                    <br />
                    <input type="checkbox" id="cangiua" name="txtCanGiua" onchange="kiemtracangiua()" />&nbsp;<b>Căn giữa tất cả đoạn Text Karaoke</b> <br />
                    <br />
                    <input type="checkbox" id="codinh1" name="txtCoDinh" checked />&nbsp;<b id="codinh2">Cố định đoạn text Karaoke ở phía dưới (như các bản karaoke thông thường)</b>
                </td>
            </tr>
            <tr style="height: 40px;">
                <td></td>
                <td>
                    <br />
                    <input onclick="xong()" style="font-weight: bolder;" type="Submit" id="okxem" value="Bắt Đầu" />
                    <br />
                    <img id="loading" src="/Image_Play/waiting.gif" style="display: none;" />
                </td>
            </tr>
            <tr style="height: 40px;">
                <td></td>
                <td>
                    <br />
                    <br />
                    <b style="color: red; background-color: aqua;">
                    - Hiện tại nếu bạn play Karaoke online trực tiếp trên website của hệ thống (tải lên các file hoặc sử dụng hosting server của riêng bạn); khi gặp các sự cố như mạng yếu hay đường truyền Internet yếu, tốc độ băng thông
                    thấp,... thì sẽ gây khó khăn và gián đoạn trong quá trình trải nghiệm.
                    <br />
                    - Chúng tôi đang triển khai HTML dịch vụ karaoke của MyWebPlay ngay trên local (offline) dành cho bạn. <a href="/karaoke_Example/karaoke-MyWebPlay.zip" download> Click vào đây</a> để tải xuống phiên bản trải nghiệm.
                    </b>
                </td>
            </tr>
            }
        </table>
        } else {
         <div id="ajax_mama">
        <div class="video-overlay" id="play">
            <table align="center" onended="loadsolar()" touchstart="xemdoubleclick()">
                <b id="error" style="color: red; display: none;background-color:yellow"></b>
                <b id="message" style="color: deeppink; display: none;background-color:aqua"><a href="#xuly" onclick="xoaerror()">Click để tắt thông báo</a></b>
                <img style="width: 50px; height: 50px; display: none;" id="loadingX" src="/Image_Play/waiting.gif" />
                <br />
                <br />
                <div id="hienlinh" style="display: none;">
                    <br />
                    <br />
                    <br />
                </div>
                &nbsp;&nbsp;&nbsp;
                <br />
                <br />
                <div id="menu" style="display: block;position: relative;">
                    @if (ViewBag.Music != ViewBag.Musix && TempData["hassinger"] != "true") {
                    <select id="chon" onchange="changeKara()" title="Có thể nhấn phím c/C để chuyển đổi chế độ">
                        <option>Chế độ Karaoke</option>
                        <option>Chế độ Ca sĩ hát</option>
                    </select>
                    } else {
                    <select id="chon" style="display: none;" onchange="changeKara()">
                        <option>Chế độ Karaoke</option>
                        <option>Chế độ Ca sĩ hát</option>
                    </select>
                    }  &nbsp
                    <button style="color: brown;" onclick="loadsolar()" id="xanh" title="Nhấn [Space] để mở/tắt toàn màn hình"><b>FULL MÀN HÌNH - OFF</b></button>
                    <button style="background-color:grey;border:none;position: absolute;bottom:0;right:0;" onclick="dongmenu()" id="xanhla" title="Đóng thẻ phần menu lại (nhấn m/M)"><b>❌</b></button>
                    @if(TempData["TK-KARA"] == "" || TempData["TK-KARA"] == null) {
                    <b id="xemthumau" style="color: #2900f5;">Chọn màu tô điểm text</b><span> : </span><input type="color" onchange="doimau()" id="mau" value="#2900f5" />
                    } else {
                    <span style="display: none;"> <b id="xemthumau" style="color: #2900f5;">Chọn màu tô điểm text</b><span> : </span><input type="color" onchange="doimau()" id="mau" value="#2900f5" /></span>
                    } <b id="xemmauthu" style="color: #efe6e6;">Chọn màu đoạn text ban đầu</b> : <input type="color" onchange="doimauX()" id="mauX" value="#efe6e6" /> 
                    <b id="xemmaudi" style="color: #e3f207;">Chọn màu cho time đếm ngược bắt đầu karaoke</b> : <input type="color" onchange="doimauY()" id="mauY" value="#e3f207" />
                    <select id="fontKieu" onchange="doiFontKieu()" title="Chọn kiểu chữ cho text hiển thị karaoke"> </select>
                    <span style="color: deeppink;"><b>Kích thước chữ : </b></span><input id="kichthuoc" type="number" style="width: 5em;" min="0" value="80" onchange="doikichthuoc()" />
                    @if((TempData["TK-KARA"] == "" || TempData["TK-KARA"] == null) && TempData["codinh"] == "false") {
                    <span style="color: deeppink;"><b>Vị trí xuất hiện : </b></span> <input id="hang" type="number" style="width: 5em;" min="0" value="0" onchange="doihang()" />
                    } else {
                    <span style="display: none; color: deeppink;"><b>Vị trí xuất hiện : </b></span> <input style="display: none; width: 5em;" id="hang" type="number" min="0" value="0" onchange="doihang()" /> } 
                    <span id="demnguockieu" style="display:none"></span>
                    <input id="kieudemnguoc" maxlength="2" title="Nhập icon đếm ngược để bắt đầu karaoke (nếu bạn nhập N thì mặc định sẽ đếm ngược cơ bản theo : 3 - 2 - 1)" onchange="doikieudemnguoc()" value="N" size="3" />
                    @if (ViewBag.SuDung == "Video") {
                    <input type="checkbox" onchange="videovua()" id="vuavideo" />
                    <b style="color: red;">Tuỳ chỉnh video (option)</b>
                    }
                    <input type="text" onchange="moanh()" title="Nhập độ mờ background (giá trị hợp lệ từ 0 - 1, có thể sử dụng định dạng thập phân)" id="anhmo" size="3" value="0.8" />
                    <input type="color" id="maunex" onchange="moanh()" title="Chọn màu sắc phông nền cho background (có thể kèm theo độ mờ)" />
                    @if (TempData["index-auto"] == null || TempData["index-auto"] == "") {
                    <button onclick="StopKaraoke()"><b style="color: darkgreen;">THOÁT</b></button>
                    } else { var i1 = TempData["index-auto"].ToString().Split("***")[0] + ""; var i2 = TempData["length-list-auto"] + ""; TempData["index-auto"] = i1; TempData["length-list-auto"] = i2; if (i1 != i2) {
                    @if (TempData["ajax_js"] == "false")
                    {
                    <button onclick="StopKaraoke()"><b style="color: darkgreen;">Đi đến bài hát tiếp theo</b></button>
                    }
                    else
                    {
                    <button style="display:none" onclick="StopKaraoke()"><b style="color: darkgreen;">Đi đến bài hát tiếp theo</b></button>
                    <select onchange="chonsongtulist()" onclick="loadlistSong()" id="listSongKara"></select>
                    }
                    } else {
                    <button style="display: none;" onclick="StopKaraoke()"><b style="color: darkgreen; display: none;">Đi đến bài hát tiếp theo</b></button>
                    }
                    @if (TempData["ajax_js"] == "false")
                    {
                    <button onclick="DungKaraoke()"><b style="color: red;" id="thutuXYZ">Huỷ trình phát Karaoke tự động (đã phát : @i1/@i2)</b></button>
                    }
                    else
                    {
                    <button onclick="DungKaraoke()"><b style="color: red;" id="thutuXYZ">Huỷ trình phát Karaoke tự động</b></button>
                    }
                    <input style="display:none" id="thutu" type="number" min="1" max="@i2" value="@i1" />
                    }
                    <span style="color: springgreen;">
                    <b><u title="Bài hát đang được phát" id="baihatXYZ">@ViewBag.BHServer</u></b>
                    </span>
                    @if (ViewBag.Share != "YES - OK" && ViewBag.BHServer != "" && ViewBag.LoginServer != "") {
                    <span></span><b style="color: red;"><a onclick="copyshare()" href="#xuly">Share Karaoke</a></b><input type="checkbox" id="saveshare" />
                    <b style="color: lawngreen;">Bao gồm luôn các setting hiện tại của bạn</b>
                    }
                    <button onclick="ghinho()"><b style="color: lightcoral;">Ghi nhớ các cài đặt</b></button> 
                    <button onclick="xoaghinho()"><b style="color: lightcoral;">Xoá ghi nhớ các cài đặt</b></button>
                    @if (TempData["codinh"] == "false") {
                    <spam> </spam>
                    <b id="demo_nen" style="color: #ffffff;">Sử dụng màu nền cho phần text : </b><input type="color" onchange="doimaunenX()" id="maunenX" value="#FFFFFF" />
                    <span></span>
                    <a href="#xuly" onclick="xoamaunen()"><b>Làm mờ nền/Xoá màu nền</b></a>
                    <span></span>
                    } @if (TempData["auto-play"] == "false") {
                    <b id="xplay1" style="color: aqua;"><a onclick="xemplayX()" href="#xuly">Play</a></b>
                    }  @if (TempData["auto-play"] == "false") {
                    <b id="xplay2" style="color: aqua;"><a onclick="xemplay()" href="#xuly">Play & full screen</a></b>
                    }  @if (ViewBag.SuDung == "Youtube") {
                    <b style="color: aqua;"><a id="re-You" onclick="restart_Youtube()" href="#xuly">Restart video Youtube</a></b>
                    }  @if (ViewBag.SuDung == "Youtube") {
                    <b style="color: aqua;"><a onclick="replay_Youtube()" href="#xuly">Restart video Youtube and karaoke</a></b>
                    }
                    <button style="color: purple;" onclick="resetKaraoke()" title="Nhấn o/O để khởi động lại"><b>KHỞI ĐỘNG LẠI/PHÁT</b></button>  
                </div>
                <div id="hienthi">
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                </div>
                <input type="text" id="txtKara1" hidden />
                <input type="text" id="txtKara2" hidden />
                @if (TempData["cangiua"] == "true") {
                <tr style="height: 40px;">
                    <td></td>
                    <td>
                        <span id="number" style="color: #e3f207; font-size: 100px; width: 5em;"></span>
                        <br />
                        <div style="text-align: center;">
                            <div id="background-X" style="display: block;">
                                <p id="thietkeKara"></p>
                                <p id="txtKaraoke1" onclick="dongmomenu()">
                                    <b><span id="xanhX1" class="word"></span></b>
                                </p>
                                <p id="txtKaraoke2" onclick="dongmomenu()">
                                    <b><span id="xanhX2" class="work"></span></b>
                                </p>
                                <span id="xui"></span>
                            </div>
                        </div>
                    </td>
                </tr>
                } else { if (TempData["codinh"] == "false") {
                <span id="number" style="color: #e3f207; font-size: 100px; float: left; width: 5em;"></span>
                <br />
                <div style="text-align: center;">
                    <div id="background-X" style="display: block;">
                        <p id="thietkeKara"></p>
                        <p id="txtKaraoke1" onclick="dongmomenu()" style="text-align: left;">
                            <b><span id="xanhX1" class="word"></span></b>
                        </p>
                        <p id="txtKaraoke2" onclick="dongmomenu()" style="text-align: right;">
                            <b><span id="xanhX2" class="work"></span></b>
                        </p>
                        <span id="xui"></span>
                    </div>
                </div>
                } else{
                <span id="number" style="color: #e3f207; font-size: 100px; bottom: 500px; position: fixed; left: 0px; width: 5em;"></span>
                <br />
                <div style="text-align: center;">
                    <div id="background-X" style="display: block;">
                        <p id="thietkeKara"></p>
                        <p id="txtKaraoke1" onclick="dongmomenu()" style="bottom: 200px; position: fixed; left: 0px;">
                            <b><span id="xanhX1" class="word"></span></b>
                        </p>
                        <p id="txtKaraoke2" onclick="dongmomenu()" style="bottom: 0px; position: fixed; right: 0px;">
                            <b><span id="xanhX2" class="work"></span></b>
                        </p>
                        <span id="xui"></span>
                    </div>
                </div>
                } }
            </table>
        </div>
        <div id="phanphoi">
            @if(ViewBag.SuDung == "") {
            <img src="@ViewBag.Background" id="myVideo" class="sqs-html5-video" style="opacity: 0.8;" />
            } else if (ViewBag.SuDung == "Video") {
            <video muted loop autoplay id="myVidex" class="sqs-html5-video">
                <source src="@ViewBag.Background" />
            </video>
            } else {
            <iframe id="myVideo" style="pointer-events: none;" src="@ViewBag.Background"> </iframe>
            }
        </div>
        </div>
        <div id="ajax_papa" style="display:none;background-color:grey;text-align:center">
            <br />
            <br />
           <b style="color:yellow">TẢI LÊN FILE TXT KARAOKE : </b><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><input type="file" id="fileTXT" />
           <br />
           <span style="color:red">Nếu nội dung file TXT của bạn bị mã hoá, vui lòng tạo lại file TXT Karaoke khác và giải mã nội dung <a href="/Home/EncryptTxtFile" target="_blank">tại đây</a></span>
           <br /><br /> <b style="color:blue">TẢI LÊN FILE MP3 GỐC (CÓ GIỌNG CA SĨ) : </b><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><input type="file" id="fileGOC" />
           <br />
            <b style="color:purple">TẢI LÊN FILE MP3 KARAOKE (ĐÃ PHÂN TÁCH) : </b><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><input type="file" id="fileKARAOKE" />
           <br />
           <br />
           <button style="color:deeppink;background-color:greenyellow" onclick="okphatnhac()"><b>PHÁT NHẠC</b></button><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><button onclick="StopKaraoke()"><b style="color: darkgreen;">THOÁT</b></button>
           <br />
           <br />
        </div>
        }
        <script src="~/lib/jquery/dist/jquery.min.js"></script>
        <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
        <script src="~/js/site.js" asp-append-version="true"></script><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> @Html.Raw(TempData["HTML-added"])
        } else if (ViewBag.Share == "YES") {
        <br />
        <h3 style="color: deeppink;">✔️ Dữ liệu Karaoke đang được tải, vui lòng chờ trong ít phút!</h3>
        <br />
        <img src="/Image_Play/waiting.gif" />
        <div style="display: none;">
            <audio id="music" autoplay hidden onplay="PlayKaraoke()" onplaying="PlayY()" onpause="PlayXKaraoke()" onended="StopKaraoke()">
                <source src="@ViewBag.Music" type="audio/mpeg" />
            </audio>
            <audio id="musix" autoplay hidden muted onplay="ToPlayKaraoke()" onplaying="PlayZ()" onpause="PlayXKaraokeX()" onended="StopKaraoke()">
                <source src="@ViewBag.Musix" type="audio/mpeg" />
            </audio>
            <textarea id="txtKara" hidden>@ViewBag.Karaoke</textarea>
            @if (ViewBag.Music == "") { @if (ViewBag.Karaoke == "karaoke") {
            <h3 style="color: aqua;">
                Bạn nên trải nghiệm tính năng này trên máy tính (PC), laptop,... nhé 😄<br />
                Lưu ý : trong khi đang trải nghiệm Karaoke, bạn không nên refresh lại trang để tránh mất dữ liệu!
            </h3>
            <br />
            }
            <h2>@Html.ActionLink("Bạn có muốn trải nghiệm phiên bản Karaoke cơ bản?", "PlayKaraoke")</h2>
            <br />
            <br />
            <table align="center">
                <h2 style="text-align: center;">Play Your Karaoke - Online (<span style="color: orange;">phiên bản thường</span>)</h2>
                <br />
                @using (Html.BeginForm("ToPlayKaraoke", "Home", FormMethod.Post, new { @enctype = "multipart/form-data" })) {
                <input type="text" id="linkKara" name="LinkKaraoke" style="display: none;" value="@ViewBag.LinkKaraoke" />
                @Html.ValidationSummary(true) @if (ViewBag.ListSong == null || ViewBag.ListSong.Length == 0) {
                <tr style="height: 40px;">
                    <td></td>
                    <td>
                        <br />
                        <b id="check" style="color: orangered;"><input id="checkdemo" onchange="democheck()" type="checkbox" name="txtChon" /> Tham khảo bản karaoke demo có sẵn trên hệ thống</b>
                        <br />
                    </td>
                </tr>
                }
                <input type="text" name="txtShare" hidden value="@ViewBag.Share" />
                @if (ViewBag.ListSong == null || ViewBag.ListSong.Length == 0) {
                <tr style="height: 40px;">
                    <td></td>
                    <td>
                        <br />
                        <b id="servercheck" style="color: hotpink;">
                        <input id="onlineServer" onchange="onlinecheck()" type="checkbox" name="txtOnlineServer" />
                        Sử dụng host server Karaoke online của bạn (mệt mỏi vì mỗi lần phải upload các file từ local 😀)
                        </b>
                        <br />
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td></td>
                    <td id="phan4" style="display: none;">
                        <br />
                        <b> Nhập host Server name Karaoke của bạn : </b> <a href="#xuly" onclick="helpKara()" style="color: crimson;">Hướng dẫn tạo host Server để play Karaoke của bạn</a>
                        <br />
                        <input type="text" id="serverX" name="txtServer" size="80" placeholder="" value="@ViewBag.Server" />
                        <br />
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td></td>
                    <td id="phan5" style="display: none;">
                        <br />
                        <b> Nhập bài hát Karaoke từ host server của bạn (lưu ý nhập chính xác) : </b>
                        <br />
                        <input id="baihatX" type="text" name="txtSong" size="80" placeholder="" value="@ViewBag.BaiHatSV" />
                        <br />
                    </td>
                </tr>
                <textarea id="songlist" hidden>@ViewBag.ListSong</textarea>
                <tr style="height: 40px;">
                    <td></td>
                    <td id="phan6" style="display: none;">
                        <br />
                        <b style="color: aqua;">
                        Bật mí tại thư mục root trên host server của bạn, bạn có thể tạo file <span style="color: deeppinkgreen;">MyListSong.txt</span>, trong đó liệt kê các bài hát Karaoke (thư mục) đang tồn tại trên host server của
                        bạn, mỗi bài hát phân biệt và cách nhau bởi kí tự Enter :
                        </b>
                        <a href="#xuly" onclick="showlist()" style="color: crimson;" id="getlist">Get all list song of your host server</a>
                        <br />
                        <br />
                    </td>
                </tr>
                } else {
                <tr style="height: 40px;">
                    <td></td>
                    <td>
                        <br />
                        <b id="servercheck" style="color: hotpink;" hidden>
                        <input id="onlineServer" checked onchange="onlinecheck()" type="checkbox" name="txtOnlineServer" />
                        Sử dụng host server Karaoke online của bạn (mệt mỏi vì mỗi lần phải upload các file từ local 😀)
                        </b>
                        <a href="#xuly" onclick="thoatServer()" style="color: hotpink;">THOÁT CHỨC NĂNG KARAOKE - YOUR HOST SERVER</a>
                        <br />
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td></td>
                    <td id="phan4" style="display: block;">
                        <br />
                        <b> Nhập host Server name Karaoke của bạn : </b> <a href="#xuly" onclick="helpKara()" style="color: crimson;">Hướng dẫn tạo host Server để play Karaoke của bạn</a>
                        <br />
                        <input readonly type="text" id="serverX" name="txtServer" size="80" placeholder="" value="@ViewBag.Server" />
                        <br />
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td></td>
                    <td id="phan5" style="display: block;">
                        <br />
                        <b> Nhập bài hát Karaoke từ host server của bạn (lưu ý nhập chính xác) : </b>
                        <br />
                        <input id="baihatX" type="text" name="txtSong" size="80" placeholder="" value="@ViewBag.BaiHatSV" />
                        <br />
                    </td>
                </tr>
                <textarea id="songlist" hidden>@ViewBag.ListSong</textarea>
                <tr style="height: 40px;">
                    <td></td>
                    <td id="phan6" style="display: block;">
                        <br />
                        <b style="color: aqua;">
                        Bật mí tại thư mục root trên host server của bạn, bạn có thể tạo file <span style="color: deeppinkgreen;">MyListSong.txt</span>, trong đó liệt kê các bài hát Karaoke (thư mục) đang tồn tại trên host server của
                        bạn, mỗi bài hát phân biệt và cách nhau bởi kí tự Enter :
                        </b>
                        <a id="getlist" href="#xuly" onclick="showlist()" style="color: crimson;">Get all list song of your host server (click try again to finish)</a>
                        <br />
                        <br />
                        <b id="soluongSong" style="color: chartreuse;"></b>
                        <br />
                        <span style="color: orangered;"><u>Lưu ý</u> : Danh sách bên dưới có thể chưa được hoàn tất do file <span style="color: deeppinkgreen;">MyListSong.txt</span> trên host server của bạn chưa được cập nhật !</span>
                        <br />
                        <br />
                        <select id="listsong" size="10" onclick="changesong()" onchange="changesong()">
                            <option></option>
                        </select>
                        <br />
                    </td>
                </tr>
                } @if (ViewBag.ListSong == null || ViewBag.ListSong.Length == 0) {
                <tr style="height: 40px;">
                    <td></td>
                    <td id="phan1">
                        <br />
                        <b> Tải file TXT karaoke (đã xử lý) || hoặc nhập url *.txt online (khuyến khích) : </b>
                        <br />
                        @if(TempData["fileSuDung"] == "true")
                        {
                        <input type="file" name="txtKaraoke" />
                        }
                        else
                        {
                        <input disabled type="file" name="txtKaraoke" />
                        }
                        &nbsp;&nbsp;
                        @if (TempData["ajax_on_no_upload"] == null || TempData["ajax_on_no_upload"] == "")
                        {
                        <input size="100" type="text" name="txtKaraoke1" />
                        }
                        <br />
                        <b>@Html.ActionLink("Bạn chưa có file text karaoke?","CreateFile_Karaoke")</b><br />
                        <b style="color: darkgreen;">@Html.ActionLink("Phân đoạn hát cho các member? (sau khi bạn đã tạo file text Karaoke từ hệ thống)","PhanDoanMember_Karaoke")</b>
                        <br />
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td></td>
                    <td id="phan2">
                        <br />
                        <b> Tải file MP3 karaoke - nhạc gốc có giọng ca sĩ (đã xử lý) || hoặc nhập url *.mp3 online (khuyến khích) : </b>
                        <br />
                        @if(TempData["fileSuDung"] == "true")
                        {
                        <input type="file" name="txtMusix" />
                        }
                        else
                        {
                        <input type="file" name="txtMusix" disabled />
                        }
                        &nbsp;&nbsp;
                        @if (TempData["ajax_on_no_upload"] == null || TempData["ajax_on_no_upload"] == "")
                                    {
                                        <input size="100" type="text" name="txtMusix1" />
                                    }
                        <br />
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td></td>
                    <td id="phan3">
                        <br />
                        <b> Tải file MP3 karaoke - nhạc beat tách giọng ca sĩ (karaoke - đã xử lý) || hoặc nhập url *.mp3 online (khuyến khích) : </b>
                        <br />
                        @if(TempData["fileSuDung"] == "true")
                        {
                        <input type="file" name="txtMusic" />
                        }
                        else
                        {
                        <input disabled type="file" name="txtMusic" />
                        }
                        &nbsp;&nbsp;
                        @if (TempData["ajax_on_no_upload"] == null || TempData["ajax_on_no_upload"] == "")
                                    {
                                        <input size="100" type="text" name="txtMusic1" />
                                    }
                        <br />
                    </td>
                </tr>
                }
                <tr style="height: 40px;">
                    <td></td>
                    <td>
                        <br />
                        <h5 style="color: chartreuse;">
                            - Sử dụng các app/web bên ngoài để giúp tách nhạc và giọng ca sĩ (nếu bạn không có bản nhạc Karaoke)
                            <br />
                            - Sử dụng các app/web bên ngoài để tăng âm lượng cho âm thanh.
                            <br />
                            - Ngoài ra bạn có thể áp dụng sự hiểu biết về photoshop/hiệu chỉnh âm thanh khác cho thích hợp nhất!
                        </h5>
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td></td>
                    <td>
                        <select id="chonKara" onchange="chonKaraHay()">
                            <option>Sử dụng ngẫu nhiên ảnh/background có sẵn trên hệ thống - hoặc vòng lặp theo thứ tự</option>
                            <option>Sử dụng link ảnh/background online của bạn</option>
                            <option>Sử dụng link video/background online của bạn</option>
                            <option>Nhập link video Youtube online</option>
                            <option>Lấy ngẫu nhiên link video Youtube hiện có (một số link có thể không còn tồn tại)</option>
                        </select>
                        <input type="number" style="width: 5em;" hidden id="chonKarax" name="KaraChon" value="1" min="1" max="5" />
                        <br />
                        <br />
                        <input name="txtOnline" id="online" size="100" style="display: none;" type="text" placeholder="Nhập link online background của bạn thực hiện karaoke..." />
                        <br />
                        <span id="helpYoutube" style="color: red; display: none;">
                        <u>Lưu ý</u> : một số link Youtube có thể không khả dụng hoặc bạn nên cố gắng thử lại (và hãy tìm video youtube dài phút nhất có thể 😃, tuy nhiên một số trường hợp video có thể tự lặp lại)
                        </span>
                        @* <br />
                        <span id="Youtubehelp" style="color: blueviolet; display: none;">
                        Với lựa chọn này, để đảm bảo sự tuyệt đối thì ban đầu nhạc sẽ không được phát tự động như bình thường.<br />
                        Bạn vui lòng tự canh đợi sau khi video Youtube trên background của bạn đã bắt đầu vừa phát, hãy nhấn phím link <span style="color: orangered;">Play & Start</span> để mới bắt đầu hành trình nhé 😁
                        </span>
                        *@ <br />
                        <br />
                        <input type="checkbox" name="auto_play" />&nbsp;<b>Không tự động phát nhạc khi bắt đầu</b> <br />
                        <br />
                        <input type="checkbox" name="auto_music" />&nbsp;<b>Tự động lặp lại music (không đảm bảo)</b> <br />
                        <br />
                        <input type="checkbox" name="txtBehind" id="behind" />&nbsp;<b>Sẽ bắt đầu phát nhạc sau <input type="number" name="txtBehindNumber" value="10" min="10" max="100" style="width: 5em;" /> giây</b> <br />
                        <br />
                        <input type="checkbox" name="txtInHoa" />&nbsp;<b>Viết in hoa tất cả đoạn Text Karaoke</b> <br />
                        <br />
                        <input type="checkbox" id="cangiua" name="txtCanGiua" onchange="kiemtracangiua()" />&nbsp;<b>Căn giữa tất cả đoạn Text Karaoke</b> <br />
                        <br />
                        <input type="checkbox" id="codinh1" name="txtCoDinh" checked />&nbsp;<b id="codinh2">Cố định đoạn text Karaoke ở phía dưới (như các bản karaoke thông thường)</b>
                    </td>
                </tr>
                <tr style="height: 40px;">
                    <td></td>
                    <td>
                        <br />
                        <input style="font-weight: bolder;" type="Submit" id="okxem" value="Bắt Đầu" />
                    </td>
                </tr>
                }
            </table>
            } else {
             <div id="ajax_mama">
            <div class="video-overlay" id="play">
                <table align="center" onended="loadsolar()">
                    <div id="hienlinh" style="display: none;">
                        <br />
                        <br />
                        <br />
                        <br />
                    </div>
                    &nbsp;&nbsp;&nbsp;
                    <br />
                    <br />
                    <div id="menu" style="display: block;position: relative;">
                        @if (ViewBag.Music != ViewBag.Musix && TempData["hassinger"] != "true") {
                        <select id="chon" onchange="changeKara()" title="Có thể nhấn phím c/C để chuyển đổi chế độ">
                            <option>Chế độ Karaoke</option>
                            <option>Chế độ Ca sĩ hát</option>
                        </select>
                        } else {
                        <select id="chon" style="display: none;" onchange="changeKara()">
                            <option>Chế độ Karaoke</option>
                            <option>Chế độ Ca sĩ hát</option>
                        </select>
                        }  &nbsp
                        <button style="color: brown;" onclick="loadsolar()" id="xanh" title="Nhấn [Space] để mở/tắt toàn màn hình"><b>FULL MÀN HÌNH - OFF</b></button> 
                        <button style="background-color:grey;border:none;absolute;bottom:0;right:0;" onclick="dongmenu()" id="xanhla" title="Đóng thẻ phần menu lại (nhấn m/M)"><b>❌</b></button>
                        @if(TempData["TK-KARA"] == "" || TempData["TK-KARA"] == null) {
                        <b id="xemthumau" style="color: #2900f5;">Chọn màu tô điểm text</b><span> : </span><input type="color" onchange="doimau()" id="mau" value="#2900f5" />
                        } else {
                        <span style="display: none;"> <b id="xemthumau" style="color: #2900f5;">Chọn màu tô điểm text</b><span> : </span><input type="color" onchange="doimau()" id="mau" value="#2900f5" /></span>
                        } <b id="xemmauthu" style="color: #efe6e6;">Chọn màu đoạn text ban đầu</b> : <input type="color" onchange="doimauX()" id="mauX" value="#efe6e6" /> 
                        <b id="xemmaudi" style="color: #e3f207;">Chọn màu cho time đếm ngược bắt đầu karaoke</b> : <input type="color" onchange="doimauY()" id="mauY" value="#e3f207" />  
                        <span style="color: red;">Kích thước chữ : </span><input id="kichthuoc" type="number" style="width: 5em;" min="0" value="90" onchange="doikichthuoc()" />
                        @if((TempData["TK-KARA"] == "" || TempData["TK-KARA"] == null) && TempData["codinh"] == "false") {
                        <span style="color: deeppink;"><b>Vị trí xuất hiện : </b></span> <input id="hang" type="number" style="width: 5em;" min="0" value="0" onchange="doihang()" />
                        } else {
                        <span style="display: none; color: deeppink;"><b>Vị trí xuất hiện : </b></span> <input style="display: none; width: 5em;" id="hang" type="number" min="0" value="0" onchange="doihang()" />
                        }  @if (ViewBag.SuDung == "Video") {
                        <input type="checkbox" onchange="videovua()" id="vuavideo" />
                        <b style="color: red;">Tuỳ chỉnh video (option)</b>
                        }
                        <input type="text" onchange="moanh()" title="Nhập độ mờ background (giá trị hợp lệ từ 0 - 1, có thể sử dụng định dạng thập phân)" id="anhmo" size="3" value="0.8" />
                        <input type="color" id="maunex" title="Chọn màu sắc phông nền cho background (có thể kèm theo độ mờ)" onchange="moanh()" />
                        @if (TempData["index-auto"] == null || TempData["index-auto"] == "") {
                        <button onclick="StopKaraoke()"><b style="color: darkgreen;">THOÁT</b></button>
                        } else { var i1 = TempData["index-auto"].ToString().Split("***")[0] + ""; var i2 = TempData["length-list-auto"] + ""; TempData["index-auto"] = i1; TempData["length-list-auto"] = i2; if (i1 != i2) {
                        @if (TempData["ajax_js"] == "false")
                        {
                        <button onclick="StopKaraoke()"><b style="color: darkgreen;">Đi đến bài hát tiếp theo</b></button>
                        }
                        else
                        {
                        <button style="display:none" onclick="StopKaraoke()"><b style="color: darkgreen;">Đi đến bài hát tiếp theo</b></button>
                        <select  onchange="chonsongtulist()" onclick="loadlistSong()" id="listSongKara"></select>
                        }
                        } else {
                        <button style="display: none;" onclick="StopKaraoke()"><b style="color: darkgreen; display: none;">Đi đến bài hát tiếp theo</b></button>
                        }
                        @if (TempData["ajax_js"] == "false")
                        {
                        <button onclick="DungKaraoke()"><b style="color: red;" id="thutuXYZ">Huỷ trình phát Karaoke tự động (đã phát : @i1/@i2)</b></button>
                        }
                        else
                        {
                        <button onclick="DungKaraoke()"><b style="color: red;" id="thutuXYZ">Huỷ trình phát Karaoke tự động</b></button>
                        }
                        <input style="display:none" id="thutu" type="number" min="1" max="@i2" value="@i1" />
                        } 
                        <span style="color: darkturquoise;">
                        <b><u>@ViewBag.BHServer</u></b>
                        </span>
                        <button onclick="ghinho()"><b style="color: lightcoral;">Ghi nhớ các cài đặt</b></button>  <button onclick="xoaghinho()"><b style="color: lightcoral;">Xoá ghi nhớ các cài đặt</b></button>
                        @if (TempData["codinh"] == "false") {
                        <spam> </spam>
                        <b id="demo_nen" style="color: #ffffff;">Sử dụng màu nền cho phần text : </b><input type="color" onchange="doimaunenX()" id="maunenX" value="#FFFFFF" />
                        <span></span>
                        <a href="#xuly" onclick="xoamaunen()"><b>Làm mờ nền/Xoá màu nền</b></a>
                        <span></span>
                        }  @if (TempData["auto-play"] == "false") {
                        <b id="xplay1" style="color: aqua;"><a onclick="xemplayX()" href="#xuly">Play</a></b>
                        }  @if (TempData["auto-play"] == "false") {
                        <b id="xplay2" style="color: aqua;"><a onclick="xemplay()" href="#xuly">Play & full screen</a></b>
                        }  @if (ViewBag.SuDung == "Youtube") {
                        <b style="color: aqua;"><a id="re-You" onclick="restart_Youtube()" href="#xuly">Restart video Youtube</a></b>
                        }  @if (ViewBag.SuDung == "Youtube") {
                        <b style="color: aqua;"><a onclick="replay_Youtube()" href="#xuly">Restart video Youtube and karaoke</a></b>
                        }
                        <button style="color: purple;" onclick="resetKaraoke()" title="Nhấn o/O để khởi động lại"><b>KHỞI ĐỘNG LẠI/PHÁT</b></button> 
                    </div>
                    <div id="hienthi">
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                        <br />
                    </div>
                    <input type="text" id="txtKara1" hidden />
                    <input type="text" id="txtKara2" hidden />
                    @if (TempData["cangiua"] == "true") {
                    <tr style="height: 40px;">
                        <td></td>
                        <td>
                            <span id="number" style="color: #e3f207; font-size: 100px; width: 5em;"></span>
                            <br />
                            <div style="text-align: center;">
                                <div id="background-X" style="display: block;">
                                    <p id="thietkeKara"></p>
                                    <p id="txtKaraoke1" onclick="dongmomenu()">
                                        <b><span id="xanhX1" class="word"></span></b>
                                    </p>
                                    <p id="txtKaraoke2" onclick="dongmomenu()">
                                        <b><span id="xanhX2" class="work"></span></b>
                                    </p>
                                    <span id="xui"></span>
                                </div>
                            </div>
                        </td>
                    </tr>
                    } else { if (TempData["codinh"] == "false") {
                    <span id="number" style="color: #e3f207; font-size: 100px; float: left; width: 5em;"></span>
                    <br />
                    <div style="text-align: center;">
                        <div id="background-X" style="display: block;">
                            <p id="thietkeKara"></p>
                            <p id="txtKaraoke1" onclick="dongmomenu()" style="text-align: left;">
                                <b><span id="xanhX1" class="word"></span></b>
                            </p>
                            <p id="txtKaraoke2" onclick="dongmomenu()" style="text-align: right;">
                                <b><span id="xanhX2" class="work"></span></b>
                            </p>
                            <span id="xui"></span>
                        </div>
                    </div>
                    } else{
                    <span id="number" style="color: #e3f207; font-size: 100px; bottom: 500px; position: fixed; left: 0px; width: 5em;"></span>
                    <br />
                    <div style="text-align: center;">
                        <div id="background-X" style="display: block;">
                            <p id="thietkeKara"></p>
                            <p id="txtKaraoke1" onclick="dongmomenu()" style="bottom: 200px; position: fixed; left: 0px;">
                                <b><span id="xanhX1" class="word"></span></b>
                            </p>
                            <p id="txtKaraoke2" onclick="dongmomenu()" style="bottom: 0px; position: fixed; right: 0px;">
                                <b><span id="xanhX2" class="work"></span></b>
                            </p>
                            <span id="xui"></span>
                        </div>
                    </div>
                    } }
                </table>
            </div>
            <div id="phanphoi">
                @if(ViewBag.SuDung == "") {
                <img src="@ViewBag.Background" id="myVideo" class="sqs-html5-video" />
                } else if (ViewBag.SuDung == "Video") {
                <video muted loop autoplay id="myVidex" class="sqs-html5-video">
                    <source src="@ViewBag.Background" />
                </video>
                } else {
                <iframe id="myVideo" style="pointer-events: none;" src="@ViewBag.Background"> </iframe>
                }
            </div>
            </div>
            <div id="ajax_papa" style="display:none;background-color:grey;text-align:center">
                <br />
                <br />
           <b style="color:yellow">TẢI LÊN FILE TXT KARAOKE : </b><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><input type="file" id="fileTXT" />
           <br />
           <span style="color:red">Nếu nội dung file TXT của bạn bị mã hoá, vui lòng tạo lại file TXT Karaoke khác và giải mã nội dung <a href="/Home/EncryptTxtFile" target="_blank">tại đây</a></span>
           <br />
           <br /> <b style="color:blue">TẢI LÊN FILE MP3 GỐC (CÓ GIỌNG CA SĨ) : </b><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><input type="file" id="fileGOC" />
           <br />
            <b style="color:purple">TẢI LÊN FILE MP3 KARAOKE (ĐÃ PHÂN TÁCH) : </b><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><input type="file" id="fileKARAOKE" />
           <br />
           <br />
           <button style="color:deeppink;background-color:greenyellow" onclick="okphatnhac()"><b>PHÁT NHẠC</b></button><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><button onclick="StopKaraoke()"><b style="color: darkgreen;">THOÁT</b></button>
           <br />
           <br />
        </div>
            }
            <script src="~/lib/jquery/dist/jquery.min.js"></script>
            <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
            <script src="~/js/site.js" asp-append-version="true"></script><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> @Html.Raw(TempData["HTML-added"])
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> @Html.Raw(TempData["HTML-added"])
        </div>
        } else if (ViewBag.Share == "ERROR") {
        <br />
        <h3 style="color: red;">⚠️ Dữ liệu bạn đang cố gắng truy cập hiện không tồn tại/không hợp lệ hoặc đang gặp sự cố, vui lòng thử lại sau!</h3>
        <br />
        <a href="/Home/ToPlayKaraoke">Back Karaoke</a>
        }
    </body>
</html>